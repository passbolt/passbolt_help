<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Passbolt Help | Update passbolt server component (v2)</title>
    <!--
             ____                  __          ____
            / __ \____  _____ ____/ /_  ____  / / /_
           / /_/ / __ `/ ___/ ___/ __ \/ __ \/ / __/
          / ____/ /_/ (__  |__  ) /_/ / /_/ / / /_
         /_/    \__,_/____/____/_.___/\____/_/\__/

         Open source password manager for teams
         © 2019 Passbolt SA

     -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta property="og:image" content="http://localhost:4000/assets/img/background/og_preview.jpg" />
    <meta property="og:title" content="Update passbolt server component (v2)" />
    <meta property="og:description" content="" />

    <link rel="stylesheet" href="http://localhost:4000/assets/css/help.min.css">
    <link rel="stylesheet" href="http://localhost:4000/assets/css/highlight.css">
    <link rel="canonical" href="http://localhost:4000/hosting/update">
    <link rel="shortcut icon" type="image/x-icon" href="http://localhost:4000/assets/favicon.ico" />
    <link rel="alternate" type="application/rss+xml" title="Passbolt | Help" href="http://localhost:4000/feed.xml">

</head>

<body>
<div id="container" class="help page background">
    <header>
        <div class="header first ">
            <nav class="greedy">
                <div class="top navigation primary">
                    <ul class="links clearfix">
                        <li class="home with-text"><a href="http://www.passbolt.com/"><span>home</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/services"><span>pricing</span></a></li>
                        <li class="left"><a href="https://demo.passbolt.com" target="_blank" rel="noopener"><span>demo</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/blog"><span>blog</span></a></li>
                        <li class="left selected"><a href="//help.passbolt.com/"><span>help</span></a></li>
                    </ul>
                    <button class="hidden" count="0">more</button>
                    <ul class="hidden-links hidden"></ul>
                </div>
            </nav>
        </div>
    </header>
    <div class="header second">
        <div class="col1">
            <div class="logo no-img">
                <h1><span>Passbolt</span></h1>
            </div>
        </div>
        <div class="col2 search-wrapper">
            <h2 class="visuallyhidden">Help Search</h2>
            <div>
                <form class="search ready" action="/search.html" method="get">
                    <div class="input required">
                        <label for="search-box">Search</label>
                        <input id="search-box" name="query" maxlength="64" placeholder="Help search" class="fuzzy-search" type="search">
                    </div>
                    <button value="search">
                        <i class="fa fa-fw fa-search"></i>
                        <span class="text visuallyhidden">search</span>
                    </button>
                </form>
            </div>
        </div>
        <div class="col3">
            <div class="edit-on-github">
                <a href="https://github.com/passbolt/passbolt_help/edit/master/_posts/2018-05-02-hosting-update-v2.md" class="button">
                    <i class="fa fa-github-alt fa-fw"></i> Edit on github</a>
            </div>
        </div>
    </div>
    <div class="panel main" aria-label="Content">
        <div class="panel left">
            
            





<div class="navigation wizard" role="navigation">
    <ul>
        <li><h2>Hosting</h2></li>
        
        
        <li>
        
            <a href="http://localhost:4000/faq/hosting">Hosting FAQ</a>
        </li>
        
        
        <li>
        
            <a href="http://localhost:4000/hosting/install">Installation</a>
        </li>
        
        
        <li class="selected">
        
            <a href="http://localhost:4000/hosting/update">Update</a>
        </li>
        
        
        <li>
        
            <a href="http://localhost:4000/hosting/upgrade">Upgrade</a>
        </li>
        
        
        <li>
        
            <a href="http://localhost:4000/hosting/backup">Backup</a>
        </li>
        
        
        <li>
        
            <a href="https://community.passbolt.com/c/installation-issues">Installation issues</a>
        </li>
        
    </ul>
</div>











            
        </div>
        <div class="panel middle" data-spy="scroll" data-target=".scrollspy">
            <div class="grid grid-responsive-12">
                <article>
                    <div class="row" id="introduction">
    <div class="col12">
        <div class="breadcrumbs">
            <ul>
                <li>
                    <div class="main-cell">
                        <a href="https://www.passbolt.com"><span>home</span></a>
                    </div>
                </li>
                <li>
                    <div class="main-cell">
                        <a href="/"><span>help</span></a>
                    </div>
                </li>
                
                <li>
                    <div class="main-cell">
                        <a href="http://localhost:4000/hosting"><span>hosting</span></a>
                    </div>
                </li>
                
                
                <li>
                    <div class="main-cell">
                        <a href="http://localhost:4000/hosting/update.html"><span>update</span></a>
                    </div>
                </li>
                
            </ul>
        </div>
    </div>
</div>

                    <div class="row" markdown="1">
<div class="col7" markdown="1">
<h1>Update passbolt server component (v2)</h1>
</div>
</div>

                    <div class="row">
  <div class="col7">

    <h2 id="which-update-process-to-follow">Which update process to follow?</h2>

    <p>Each passbolt release follows the concept of <a href="http://www.semver.org">Semantic Versioning</a>. Given a version number MAJOR.MINOR.PATCH, we increment as follow:</p>

    <ul>
      <li><strong>PATCH</strong> version when we make backwards-compatible bug fixes. So let’s say you are running passbolt v2.0.2 and the latest one available is v2.0.3 you will need to perform a patch update.</li>
      <li><strong>MINOR</strong> version when we add functionality in a backwards-compatible manner. Similarly say you have passbolt v2.0.3 installed and the latest version available is v2.1.0, you will need to perform a minor version update.</li>
      <li><strong>MAJOR</strong> version when incompatible API changes are made. You get the deal for major version update: that would mean going from v1 to v2 for example.</li>
    </ul>

    <h2 id="where-to-find-the-latest-release-version-number">Where to find the latest release version number?</h2>

    <p>You can find information about which version is the latest in the <a href="/releases">release notes</a>. It is generally a good idea to check these notes before running an update. You can also find it on the official <a href="https://github.com/passbolt/passbolt_api/blob/master/config/version.php">GIT repository</a>.</p>

    <h2 id="where-to-find-the-version-number-for-a-given-installation">Where to find the version number for a given installation?</h2>

    <p>You can check <code class="highlighter-rouge">app/Config/version.php</code> to know the version number for your local instance. You can also hover on the <em><span class="visuallyhidden">heart</span></em> icon at the bottom right corner of any passbolt screen. The first item is the server version, the second the one from the browser extension.</p>

    <figure>
    <img src="http://localhost:4000/assets/img/help/2018/05/AN_footer_version_help.png" alt="footer version helper" style="max-width:210px;" />
    <span class="legend">fig. footer version helper</span>
</figure>

    <h2 id="major-update">Major update</h2>

    <p>Please see the following documentation to <a href="/hosting/upgrade">Update from v1 to v2</a></p>

    <h2 id="minor-update">Minor update</h2>

    <p>Every now and again some releases will introduce some database and/or configuration files changes. 
Here is a step by step guide on how to perform a minor update. Just replace the version numbers where necessary.</p>

    <h4 id="take-your-site-down">1. Take your site down</h4>

    <p>Create a temporary webserver configuration to redirect all the requests to a maintenance page. 
You can find resources how to do this online: <a href="http://stackoverflow.com/questions/21709026/apache-enable-maintenance-mode-across-all-virtual-hosts">here is an example for apache</a> .</p>

    <h4 id="get-the-latest-release">2. Get the latest release</h4>

    <p>You can also pull the latest version directly from master:</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>git pull origin master
</code></pre></div>    </div>

    <p>You can also pull specific versions:</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>git fetch
<span class="nv">$ </span>git checkout tags/v2.3.0
</code></pre></div>    </div>

    <h4 id="update-the-libraries">3. Update the libraries</h4>

    <p>Some libraries are not packaged with the software but need to be updated using composer, based on 
what is recommended in the composer.lock. This file is provided by passbolt.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>composer <span class="nb">install</span> <span class="nt">--no-dev</span>
</code></pre></div>    </div>

    <h4 id="run-the-migration-script">4. Run the migration script</h4>

    <p>You can run the database migration scripts as follow:</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>./bin/cake passbolt migrate <span class="nt">--backup</span>
</code></pre></div>    </div>

    <p>As you can see with the command above you can optional ask the application to create a database backup.
This is usefull in case you run into any issues with the new version and need to revert to an old but working one.</p>

    <p>This backup will be placed in <code class="highlighter-rouge">./tmp/cache/database/backup/backup_timestamp.sql</code>.</p>

    <h4 id="clear-the-cache">5. Clear the cache</h4>
    <p>Finally make sure you clear the application cache, to make sure any changes in the database structure are
reflected in model cache files:</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>./bin/cake cache clear_all
</code></pre></div>    </div>

    <h4 id="put-your-site-back-online">6. Put your site back online!</h4>

    <p>As an administrator (or as any user in debug mode) you can go and check on the /healthcheck page to see 
if your instance configuration is looking good.</p>

    <h2 id="patch-update">Patch update</h2>

    <p>Performing a patch update is the easiest. All you need to do is checkout the latest version.</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>git pull origin master
</code></pre></div>    </div>

    <p>You can also checkout a specific version and use branches to switch versions. For example for version 2.0.3:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>git fetch <span class="nt">--tags</span>
<span class="nv">$ </span>git checkout tags/v2.3.0 <span class="nt">-b</span> tags/v2.3.0
</code></pre></div>    </div>

    <h2 id="troubleshooting">Troubleshooting</h2>

    <h4 id="verifying-the-status-of-the-application">Verifying the status of the application</h4>
    <p>Optionally, you can login as an administrator and check the status on the healthcheck page:</p>

    <figure>
    <img src="http://localhost:4000/assets/img/screenshots/AD_healthcheck.jpg" alt="Example of healthcheck screen" style="max-width:;" />
    <span class="legend">fig. Example of healthcheck screen</span>
</figure>

    <p>You can also run the following command:</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./bin/cake passbolt healthcheck
</code></pre></div>    </div>

    <h4 id="if-you-run-into-some-issues">If you run into some issues</h4>

    <p>If you run into some issues:</p>
    <ul>
      <li>Make a copy or screenshot of the errors messages displayed on the screen</li>
      <li>Check for error message in the <code class="highlighter-rouge">logs</code> directory</li>
      <li>Check for error message in the browser console</li>
      <li>Checkout the previous working version using git</li>
      <li>Drop the database and load your backup data to restore to a previously working version</li>
      <li>Note down the the details of you environment: your OS, php, mysql environment versions.</li>
    </ul>

    <p>Where to get help:</p>
    <ul>
      <li>If you are a Passbolt Pro Edition subscriber send us an <a href="mailto:contact@passbolt.com">email</a> with the details.</li>
      <li>If you are a Passbolt Community Edition user you can open new thread on the <a href="https://community.passbolt.com/c/installation-issues">community forum</a>.</li>
    </ul>

    <p>The more information you provide about what you did, what you tried, how your environment look like,
the easiest it will be for people to help you.</p>

    <div class="last-updated">
      <h3>Last updated</h3>
      <p>This article was last updated on 
May
2nd,
2018.</p>
    </div>

  </div>
  <div class="col4 last push1">

    <div class="message tldr">
    <p>Are you still using passbolt v1? Check out the previous version of this article.</p>
    
    <a href="/hosting/update-v1" class="button ">See previous version</a>
    
</div>

    <div class="message tldr notice">
    <p>Are you experiencing issues when updating passbolt?</p>
    
    <a href="https://community.passbolt.com/c/installation-issues" class="button primary">Ask the community!</a>
    
</div>

    <div class="message ">
    <p></p>
    
</div>

  </div>
</div>

                </article>
            </div>
        </div>
    </div>
    <footer>
        <div class="footer">
            <ul class="footer-links">
                <li><a href="https://www.passbolt.com/licence">Terms</a></li>
                <li><a href="https://www.passbolt.com/privacy">Privacy</a></li>
                <li><a href="https://www.passbolt.com/credits">Credits</a></li>
                <li><a href="https://careers.passbolt.com">Careers</a></li>
            </ul>
        </div>
    </footer>
</div>
<!-- Piwik -->
<script type="text/javascript">
  var _paq = _paq || [];
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//passbolt.piwikpro.com/";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', 1]);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<noscript><p><img src="//passbolt.piwikpro.com//piwik.php?idsite=1" style="border:0;" alt="" /></p></noscript>
<!-- End Piwik Code -->
<script src="https://code.jquery.com/jquery-3.3.1.min.js" crossorigin="anonymous"
        integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="></script>
<script src="http://localhost:4000/assets/js/greedynav.js"></script>
</body>
</html>
