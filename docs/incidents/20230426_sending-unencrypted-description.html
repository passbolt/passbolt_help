<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Passbolt Help | Sending unencrypted description during resource creation on Android app</title>
    <!--
             ____                  __          ____
            / __ \____  _____ ____/ /_  ____  / / /_
           / /_/ / __ `/ ___/ ___/ __ \/ __ \/ / __/
          / ____/ /_/ (__  |__  ) /_/ / /_/ / / /_
         /_/    \__,_/____/____/_.___/\____/_/\__/

         Open source password manager for teams
         ¬© 2019 Passbolt SA

     -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta property="og:image" content="https://help.passbolt.com/assets/img/background/og_preview.jpg" />
    <meta property="og:title" content="Sending unencrypted description during resource creation on Android app" />
    <meta property="og:description" content="" />
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/help.min.css">
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/highlight.css">
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/cookie-eu-banner.css">
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/custom.css">
    <link rel="canonical" href="https://help.passbolt.com/incidents/20230426_sending-unencrypted-description">
    <link rel="shortcut icon" type="image/x-icon" href="https://help.passbolt.com/assets/favicon.ico" />
    <link rel="alternate" type="application/rss+xml" title="Passbolt | Help" href="https://help.passbolt.com/feed.xml">
</head>


<body>
    <div id="container" class="help page background">
            <header>
        <div class="header first ">
            <nav class="greedy">
                <div class="top navigation primary">
                    <ul class="links clearfix">
                        <li class="home with-text"><a href="http://www.passbolt.com/"><span>home</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/services"><span>pricing</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/roadmap"><span>roadmap</span></a></li>
                        <li class="left"><a href="https://community.passbolt.com/"><span>forum</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/blog"><span>blog</span></a></li>
                        <li class="left selected"><a href="https://help.passbolt.com/"><span>help</span></a></li>
                        <li class="left"><a href="https://demo.passbolt.com" class="highlighted" target="_blank" rel="noopener"><span>try it!</span></a></li>
                    </ul>
                    <button class="hidden" count="0">more</button>
                    <ul class="hidden-links hidden"></ul>
                </div>
            </nav>
        </div>
    </header>
    <div class="header second">
        <div class="col1">
            <div class="logo no-img">
                <h1><span>Passbolt</span></h1>
            </div>
        </div>
        <div class="col2 search-wrapper">
            <h2 class="visuallyhidden">Help Search</h2>
            <div>
                <form class="search ready" action="/search.html" method="get">
                    <div class="input required">
                        <label for="search-box">Search</label>
                        <input id="search-box" name="query" maxlength="64" placeholder="Help search" class="fuzzy-search" type="search">
                    </div>
                    <button value="search">
                        <i class="fa fa-fw fa-search"></i>
                        <span class="text visuallyhidden">search</span>
                    </button>
                </form>
            </div>
        </div>
        <div class="col3">
            <div class="edit-on-github">
                <a href="https://github.com/passbolt/passbolt_help/edit/master/_incidents/2023-04-26-Sending-unencrypted-description.md" class="button">
                    <i class="fa fa-github-alt fa-fw"></i> Edit on github</a>
            </div>
        </div>
    </div>

        <div class="panel main" aria-label="Content">
            <div class="panel left">
                <div class="navigation-help" role="navigation">
    <ul>
        <li><h2>Incidents</h2></li>

        
        <li>
        
            <a href="/incidents">All incidents</a>
        </li>

        
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20240610_cloud-performance-degradation">
June
12th,
2024
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/reflective-html-injection-vulnerability">
April
17th,
2024
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/pwned-password-service-information-leak">
April
17th,
2024
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20240415_PBL-11-security-audit-results">
April
15th,
2024
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20230911_PBL-09-security-audit-results">
September
11th,
2023
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20230710_PBL-08-security-audit-results">
July
10th,
2023
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20230701_cloud-outage">
July
3rd,
2023
</a>
        </li>
        
        
        <li class="selected">
        
            <a href="https://help.passbolt.com/incidents/20230426_sending-unencrypted-description">
April
26th,
2023
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20230404_android-app-unlisted">
April
5th,
2023
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20220920_spell-jacking">
September
20th,
2022
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/220220118_PBL-06-security-audit-results">
January
19th,
2022
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/220211215_Clout-outage">
December
15th,
2021
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20211124_PBL_06_008_v331_Cure53_report">
November
24th,
2021
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20210419_PBL01_Cure53_report">
October
19th,
2021
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20210210_v3_webextension_issues">
February
10th,
2021
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20191126_autofill_suggestions">
November
26th,
2019
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20190807_multiple_vulnerabilities">
August
7th,
2019
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20190211_multiple_vulnerabilities">
February
11th,
2019
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20181109_gke_incident">
November
9th,
2018
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20180509_nginx_webroot_configuration">
May
9th,
2018
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20180508_password_generator_prng">
May
8th,
2018
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20171228_content_scripts_malicious_domain">
December
28th,
2017
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20171013_passphrase_information_leakage">
October
13th,
2017
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20170914_xss_on_resource_urls">
September
14th,
2017
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20170210_chrome_not_available">
February
10th,
2017
</a>
        </li>
        

    </ul>
</div>

            </div>
            <div class="panel middle" data-spy="scroll" data-target=".scrollspy">
                <div class="grid grid-responsive-12">
                    <article>
                        <div class="row" id="introduction">
    <div class="col12">
        <div class="breadcrumbs">
            <ul>
                <li>
                    <div class="main-cell">
                        <a href="https://www.passbolt.com"><span>home</span></a>
                    </div>
                </li>
                <li>
                    <div class="main-cell">
                        <a href="/"><span>help</span></a>
                    </div>
                </li>
                
                
                <li>
                    <div class="main-cell">
                        <a href="https://help.passbolt.com/incidents"><span>incidents</span></a>
                    </div>
                </li>
                
                
                
                
                <li>
                    <div class="main-cell">
                        <a href="https://help.passbolt.com/incidents/20230426_sending-unencrypted-description"><span>sending-unencrypted-description</span></a>
                    </div>
                </li>
                
            </ul>
        </div>
    </div>
</div>

                        <div class="row" markdown="1">
<div class="col7" markdown="1">
<h1>Sending unencrypted description during resource creation on Android app</h1>
</div>
</div>

                        <div class="row">
  <div class="col7">

    <h2 id="summary">Summary</h2>
    <p>Android app prior 1.13.1. maybe leak of confidential information via by sending unencrypted the content
of the description field, when the resource type ‚Äúpassword with encrypted description‚Äù is selected.</p>

    <ul>
      <li><strong>CVE:</strong> N/A</li>
      <li><strong>Product affected:</strong> API (Pro and CE) and the Android app</li>
      <li><strong>Versions affected:</strong>
        <ul>
          <li>API version under v3.12.2</li>
          <li>Android app under 1.13.2</li>
        </ul>
      </li>
      <li><strong>Version fixed:</strong>
        <ul>
          <li>API v3.12.2</li>
          <li>Android app 1.13.2</li>
        </ul>
      </li>
      <li><strong>Affected component:</strong> Resources creation form.</li>
      <li><strong>Vulnerability Type:</strong> Information leak</li>
      <li><strong>Severity:</strong> Medium</li>
    </ul>

    <h2 id="problem">Problem</h2>

    <p>When creating a resource from the Android app an unencrypted version of the description was sent to the API 
along with its encrypted version contained in the secret. However the default content type (password-and-description) 
should not contain the unencrypted version of the description.</p>

    <figure>
    <img src="https://help.passbolt.com/assets/img/help/2023/04/incident26april2023.png" alt="1. example of payload sent to the API while a new resource is created" style="max-width:500px;" />
    <span class="legend">fig. 1. example of payload sent to the API while a new resource is created</span>
</figure>

    <p>On top of that as the API didn‚Äôt ignore the sent unencrypted description, the API stored it in cleartext along 
with the resource‚Äôs metadata in the database.</p>

    <h3 id="attack-vector--exploitation">Attack vector / exploitation</h3>
    <p>As the API stored the unencrypted version of the description in the database and didn‚Äôt perform a validation of 
the data when retrieving it, the unencrypted description was returned along with the resource‚Äôs metadata when 
a client requested it via the API.</p>

    <figure>
    <img src="https://help.passbolt.com/assets/img/help/2023/04/incident26april2023_exploitation.png" alt="2. example of payload retrieved from the API when retrieving a resource" style="max-width:500px;" />
    <span class="legend">fig. 2. example of payload retrieved from the API when retrieving a resource</span>
</figure>

    <p>An attacker who performed a man-in-the-middle (MitM) attack could see the resource description in cleartext 
in the payload of the resource creation request.</p>

    <p>Additionally, an attacker who gained access to the database could read the description in cleartext from the resources 
table.</p>

    <h2 id="whos-impacted">Who‚Äôs impacted</h2>
    <p>Organizations that have users who created resources with a non-empty description from their Android app or 
directly via the API if this one was misused. Note that only the resources created are impacted, and that the 
issue is not occurring during the edit process.</p>

    <h2 id="root-cause">Root cause</h2>
    <p>The root cause is a combination of issues involving the Android app as well as the API.</p>

    <h3 id="android-app">Android App</h3>
    <p>The Use Case class for creating a resource for both two initial resource types (encrypted password, encrypted 
password with encrypted description) is reused. At first, only the encrypted password with plain text description 
resource type was supported and then the second one was added on top.</p>

    <p>During the implementation of the second resource type, the encrypted description was added into the secret, but it 
had been missed when updating the value of the original description field, so it stayed the same.</p>

    <h3 id="api">API</h3>
    <p>The API was not strict while asserting the metadata of the created resources having the type password-and-description, 
therefore letting the unwanted unencrypted description pass the validation and get stored in the database.</p>

    <h1 id="how-to-fix-the-issue">How to fix the issue</h1>
    <p>Users and administrators are advised to upgrade to the lastest API and Android application version.</p>

    <h2 id="what-was-done-to-fix-the-issue">What was done to fix the issue</h2>
    <ul>
      <li>MOB-1250 Fix the Android app by not sending the description field to the backend during resource creation</li>
      <li>PB-24315 Add validation of received resource fields on the backend according to the schema</li>
      <li>PB-24315 Run a script to clear the description field in all resources of type encrypted password with encrypted description</li>
    </ul>

    <h2 id="event-timeline">Event Timeline</h2>

    <ul>
      <li>20/04/2023 - Bug identified by Mobile team during UAT</li>
      <li>26/04/2023 - Android app fixed with 1.13.2</li>
      <li>26/04/2023 - API fixed with v3.12.2</li>
    </ul>

    <div class="last-updated">
      <h3>Last updated</h3>
      <p>This article was last updated on 
April
26th,
2023.</p>
    </div>

  </div>
  <div class="col4 last push1">
    <div class="tldr message success">
    <h4>Current status:</h4>
    1. Acknowledge issue with reporter<br />
    2. Get a fix/patch prepared<br />
    3. Release new version<br />
    4. Prepare a report about the issue<br />
    <strong>5. Feature the problem in the release</strong>
    <h5>Last updated: 2023-04-26 13:20:00 CET</h5>
</div>
  </div>
</div>

                    </article>
                </div>
            </div>
        </div>
            <footer>
        <div class="footer">
            <ul class="footer-links">
                <li><a href="https://www.passbolt.com/licence">Terms</a></li>
                <li><a href="https://www.passbolt.com/privacy">Privacy</a></li>
                <li><a href="https://www.passbolt.com/credits">Credits</a></li>
                <li><a href="https://careers.passbolt.com">Careers</a></li>
            </ul>
        </div>
    </footer>
    <div id="cookies-eu-banner" class="visually-hidden">
        üç™ &nbsp; Do you accept cookies for statistical purposes?
        <a href="https://www.passbolt.com/privacy" id="cookies-eu-more">(Read more)</a>
        <a class="button primary" id="cookies-eu-accept">Accept</a>
        <a id="cookies-eu-reject">No thanks!</a>
    </div>


    </div>
    <script src="https://consent.cookiebot.com/uc.js" data-cbid="900808a8-f178-4994-b2ad-66bf3ccca5f7" data-blockingmode="auto" strategy="beforeInteractive"></script>
<script src="https://help.passbolt.com/assets/js/matomo-tag-manager.js"></script>
<script src="https://help.passbolt.com/assets/js/matomo-analytics.js"></script>
<script src="https://code.jquery.com/jquery-3.5.0.slim.min.js" integrity="sha384-/IFzzQmt1S744I+IQO4Mc1uphkxbXt1tEwjQ/qSw2p8pXWck09sLvqHmKDYYwReJ" crossorigin="anonymous"></script>
<script src="https://help.passbolt.com/assets/js/analytics.js"></script>
<script src="https://help.passbolt.com/assets/js/greedynav.js"></script>
</body>

</html>