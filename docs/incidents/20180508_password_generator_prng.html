<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Passbolt Help | Password generator PRNG</title>
    <!--
             ____                  __          ____
            / __ \____  _____ ____/ /_  ____  / / /_
           / /_/ / __ `/ ___/ ___/ __ \/ __ \/ / __/
          / ____/ /_/ (__  |__  ) /_/ / /_/ / / /_
         /_/    \__,_/____/____/_.___/\____/_/\__/

         Open source password manager for teams
         ¬© 2019 Passbolt SA

     -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta property="og:image" content="https://help.passbolt.com/assets/img/background/og_preview.jpg" />
    <meta property="og:title" content="Password generator PRNG" />
    <meta property="og:description" content="" />
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/help.min.css">
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/highlight.css">
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/cookie-eu-banner.css">
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/custom.css">
    <link rel="canonical" href="https://help.passbolt.com/incidents/20180508_password_generator_prng">
    <link rel="shortcut icon" type="image/x-icon" href="https://help.passbolt.com/assets/favicon.ico" />
    <link rel="alternate" type="application/rss+xml" title="Passbolt | Help" href="https://help.passbolt.com/feed.xml">
</head>


<body>
    <div id="container" class="help page background">
            <header>
        <div class="header first ">
            <nav class="greedy">
                <div class="top navigation primary">
                    <ul class="links clearfix">
                        <li class="home with-text"><a href="http://www.passbolt.com/"><span>home</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/services"><span>pricing</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/roadmap"><span>roadmap</span></a></li>
                        <li class="left"><a href="https://community.passbolt.com/"><span>forum</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/blog"><span>blog</span></a></li>
                        <li class="left selected"><a href="https://help.passbolt.com/"><span>help</span></a></li>
                        <li class="left"><a href="https://demo.passbolt.com" class="highlighted" target="_blank" rel="noopener"><span>try it!</span></a></li>
                    </ul>
                    <button class="hidden" count="0">more</button>
                    <ul class="hidden-links hidden"></ul>
                </div>
            </nav>
        </div>
    </header>
    <div class="header second">
        <div class="col1">
            <div class="logo no-img">
                <h1><span>Passbolt</span></h1>
            </div>
        </div>
        <div class="col2 search-wrapper">
            <h2 class="visuallyhidden">Help Search</h2>
            <div>
                <form class="search ready" action="/search.html" method="get">
                    <div class="input required">
                        <label for="search-box">Search</label>
                        <input id="search-box" name="query" maxlength="64" placeholder="Help search" class="fuzzy-search" type="search">
                    </div>
                    <button value="search">
                        <i class="fa fa-fw fa-search"></i>
                        <span class="text visuallyhidden">search</span>
                    </button>
                </form>
            </div>
        </div>
        <div class="col3">
            <div class="edit-on-github">
                <a href="https://github.com/passbolt/passbolt_help/edit/master/_incidents/2018-05-08-password-generator-prng.md" class="button">
                    <i class="fa fa-github-alt fa-fw"></i> Edit on github</a>
            </div>
        </div>
    </div>

        <div class="panel main" aria-label="Content">
            <div class="panel left">
                <div class="navigation-help" role="navigation">
    <ul>
        <li><h2>Incidents</h2></li>

        
        <li>
        
            <a href="/incidents">All incidents</a>
        </li>

        
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/220220118_PBL-06-security-audit-results">
January
19th,
2022
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/220211215_Clout-outage">
December
15th,
2021
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20211124_PBL_06_008_v331_Cure53_report">
November
24th,
2021
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20210419_PBL01_Cure53_report">
October
19th,
2021
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20210210_v3_webextension_issues">
February
10th,
2021
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20191126_autofill_suggestions">
November
26th,
2019
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20190807_multiple_vulnerabilities">
August
7th,
2019
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20190211_multiple_vulnerabilities">
February
11th,
2019
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20181109_gke_incident">
November
9th,
2018
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20180509_nginx_webroot_configuration">
May
9th,
2018
</a>
        </li>
        
        
        <li class="selected">
        
            <a href="https://help.passbolt.com/incidents/20180508_password_generator_prng">
May
8th,
2018
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20171228_content_scripts_malicious_domain">
December
28th,
2017
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20171013_passphrase_information_leakage">
October
13th,
2017
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20170914_xss_on_resource_urls">
September
14th,
2017
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20170210_chrome_not_available">
February
10th,
2017
</a>
        </li>
        

    </ul>
</div>

            </div>
            <div class="panel middle" data-spy="scroll" data-target=".scrollspy">
                <div class="grid grid-responsive-12">
                    <article>
                        <div class="row" id="introduction">
    <div class="col12">
        <div class="breadcrumbs">
            <ul>
                <li>
                    <div class="main-cell">
                        <a href="https://www.passbolt.com"><span>home</span></a>
                    </div>
                </li>
                <li>
                    <div class="main-cell">
                        <a href="/"><span>help</span></a>
                    </div>
                </li>
                
                
                <li>
                    <div class="main-cell">
                        <a href="https://help.passbolt.com/incidents"><span>incidents</span></a>
                    </div>
                </li>
                <li>
                    <div class="main-cell">
                        <a href="https://help.passbolt.com/incidents/"><span></span></a>
                    </div>
                </li>
                
                
                
                <li>
                    <div class="main-cell">
                        <a href="https://help.passbolt.com/incidents/20180508_password_generator_prng"><span>2018-05-08 Password generator PRNG</span></a>
                    </div>
                </li>
                
            </ul>
        </div>
    </div>
</div>

                        <div class="row" markdown="1">
<div class="col7" markdown="1">
<h1>Password generator PRNG</h1>
</div>
</div>

                        <div class="row">
  <div class="col7">

    <h2 id="summary">Summary</h2>

    <p>Passbolt Web Extension version v1 does not use a cryptographically secure pseudo random generator when automatically 
generating random passwords for the user.</p>

    <ul>
      <li><strong>CVE:</strong> N/A.</li>
      <li><strong>Product affected:</strong> Passbolt Browser Extension.</li>
      <li><strong>Version affected:</strong> v1.6.10 and below</li>
      <li><strong>Version fixed:</strong> v2.0.5.</li>
      <li><strong>Affected component:</strong> Password generator.</li>
      <li><strong>Vulnerability Type:</strong> Use of Dangerous API.</li>
      <li><strong>Severity:</strong> Low (2.3).</li>
    </ul>

    <h3 id="attack-vector--exploitation">Attack vector / exploitation</h3>

    <p>An attacker running a malicious script running on the same page (and theoretically in another tab/extension), 
could try to guess the possible PRNG seed values to predict the result of the unsecure random calls that are used 
to seed passbolt password generator.</p>

    <p>The attacker would need to have a malicious script running on the page and know the time the password generation 
button is pressed for this attack to be exploitable in practice. This would still not provide the generated password 
to the attacker, but a list of possible values that could be used as part of a brute force attack.</p>

    <h3 id="credits">Credits</h3>

    <p>This issue was found and reported by Matthias vd Meent.</p>

    <h2 id="other-information">Other information</h2>

    <h3 id="how-did-you-fix-this">How did you fix this?</h3>

    <p>The function used secretComplexity.generate() uses the Math.random method it should have been using 
window.crypto.genRandomValues() instead, like in the rest of the code.</p>

    <h3 id="do-i-need-to-change-my-passwords">Do I need to change my passwords?</h3>

    <p>Even considering the low exploitability of this vulnerability, we still recommend to rotate the passwords that were 
generated by passbolt.</p>

    <h3 id="are-other-part-of-the-code-affected">Are other part of the code affected?</h3>

    <p>Other part of the code using PRNG (such as the secret Key generator during the setup) are not affected, as they 
already use a secure PRNG.</p>

    <h3 id="event-timeline">Event timeline</h3>

    <ul>
      <li>2018-05-07 17:00 CET: Vulnerability details sent by reporter.</li>
      <li>2018-05-07 17:00 CET: We acknowledge the issue, start working on a fix and start looking for similar issues in other part of the code.</li>
      <li>2018-05-08 08:30 CET: We release a fix on passbolt development repository and start testing with continuous integration tools.</li>
      <li>2018-05-08 09:00 PM CET: We deploy a fix on chrome and firefox web extension stores.</li>
      <li>2018-05-08 12:00 PM CET: We notify the reporter that a fix has been deployed.</li>
      <li>2018-05-08 12:00 PM CET: We publish the fix on github, the release notes and this report.</li>
    </ul>

    <div class="last-updated">
      <h3>Last updated</h3>
      <p>This article was last updated on 
May
8th,
2018.</p>
    </div>
  </div>
  <div class="col4 last push1">
    <div class="tldr message success">
    <h4>Current status:</h4>
    1. Try first to reproduce the issue<br />
    2. Acknowledge to the reporter<br />
    3. Get a fix/patch prepared<br />
    4. Release new version.<br />
    5. Prepare a report about the issue.<br />
    <strong>6. Feature the problem in the release.</strong>
    <h5>Last updated: 2018-05-08 12:00 PM CET</h5>
</div>
  </div>
</div>

                    </article>
                </div>
            </div>
        </div>
            <footer>
        <div class="footer">
            <ul class="footer-links">
                <li><a href="https://www.passbolt.com/licence">Terms</a></li>
                <li><a href="https://www.passbolt.com/privacy">Privacy</a></li>
                <li><a href="https://www.passbolt.com/credits">Credits</a></li>
                <li><a href="https://careers.passbolt.com">Careers</a></li>
            </ul>
        </div>
    </footer>
    <div id="cookies-eu-banner" class="visually-hidden">
        üç™ &nbsp; Do you accept cookies for statistical purposes?
        <a href="https://www.passbolt.com/privacy" id="cookies-eu-more">(Read more)</a>
        <a class="button primary" id="cookies-eu-accept">Accept</a>
        <a id="cookies-eu-reject">No thanks!</a>
    </div>


    </div>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-23506466-3"></script>
<script src="https://code.jquery.com/jquery-3.5.0.slim.min.js" integrity="sha384-/IFzzQmt1S744I+IQO4Mc1uphkxbXt1tEwjQ/qSw2p8pXWck09sLvqHmKDYYwReJ" crossorigin="anonymous"></script>
<script src="https://help.passbolt.com/assets/js/cookies-eu-banner.js"></script>
<script src="https://help.passbolt.com/assets/js/analytics.js"></script>
<script src="https://help.passbolt.com/assets/js/greedynav.js"></script>
</body>

</html>