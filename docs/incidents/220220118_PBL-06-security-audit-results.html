<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Passbolt Help | PBL-06 Security audit results</title>
    <!--
             ____                  __          ____
            / __ \____  _____ ____/ /_  ____  / / /_
           / /_/ / __ `/ ___/ ___/ __ \/ __ \/ / __/
          / ____/ /_/ (__  |__  ) /_/ / /_/ / / /_
         /_/    \__,_/____/____/_.___/\____/_/\__/

         Open source password manager for teams
         © 2019 Passbolt SA

     -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta property="og:image" content="https://help.passbolt.com/assets/img/background/og_preview.jpg" />
    <meta property="og:title" content="PBL-06 Security audit results" />
    <meta property="og:description" content="" />
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/help.min.css">
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/highlight.css">
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/cookie-eu-banner.css">
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/custom.css">
    <link rel="canonical" href="https://help.passbolt.com/incidents/220220118_PBL-06-security-audit-results">
    <link rel="shortcut icon" type="image/x-icon" href="https://help.passbolt.com/assets/favicon.ico" />
    <link rel="alternate" type="application/rss+xml" title="Passbolt | Help" href="https://help.passbolt.com/feed.xml">
</head>


<body>
    <div id="container" class="help page background">
            <header>
        <div class="header first ">
            <nav class="greedy">
                <div class="top navigation primary">
                    <ul class="links clearfix">
                        <li class="home with-text"><a href="http://www.passbolt.com/"><span>home</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/services"><span>pricing</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/roadmap"><span>roadmap</span></a></li>
                        <li class="left"><a href="https://community.passbolt.com/"><span>forum</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/blog"><span>blog</span></a></li>
                        <li class="left selected"><a href="https://help.passbolt.com/"><span>help</span></a></li>
                        <li class="left"><a href="https://demo.passbolt.com" class="highlighted" target="_blank" rel="noopener"><span>try it!</span></a></li>
                    </ul>
                    <button class="hidden" count="0">more</button>
                    <ul class="hidden-links hidden"></ul>
                </div>
            </nav>
        </div>
    </header>
    <div class="header second">
        <div class="col1">
            <div class="logo no-img">
                <h1><span>Passbolt</span></h1>
            </div>
        </div>
        <div class="col2 search-wrapper">
            <h2 class="visuallyhidden">Help Search</h2>
            <div>
                <form class="search ready" action="/search.html" method="get">
                    <div class="input required">
                        <label for="search-box">Search</label>
                        <input id="search-box" name="query" maxlength="64" placeholder="Help search" class="fuzzy-search" type="search">
                    </div>
                    <button value="search">
                        <i class="fa fa-fw fa-search"></i>
                        <span class="text visuallyhidden">search</span>
                    </button>
                </form>
            </div>
        </div>
        <div class="col3">
            <div class="edit-on-github">
                <a href="https://github.com/passbolt/passbolt_help/edit/master/_incidents/2022-01-18-PBL-06-security-audit-results.md" class="button">
                    <i class="fa fa-github-alt fa-fw"></i> Edit on github</a>
            </div>
        </div>
    </div>

        <div class="panel main" aria-label="Content">
            <div class="panel left">
                <div class="navigation-help" role="navigation">
    <ul>
        <li><h2>Incidents</h2></li>

        
        <li>
        
            <a href="/incidents">All incidents</a>
        </li>

        
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20230911_PBL-09-security-audit-results">
September
11th,
2023
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20230710_PBL-08-security-audit-results">
July
10th,
2023
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20230701_cloud-outage">
July
3rd,
2023
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20230426_sending-unencrypted-description">
April
26th,
2023
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20230404_android-app-unlisted">
April
5th,
2023
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20220920_spell-jacking">
September
20th,
2022
</a>
        </li>
        
        
        <li class="selected">
        
            <a href="https://help.passbolt.com/incidents/220220118_PBL-06-security-audit-results">
January
19th,
2022
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/220211215_Clout-outage">
December
15th,
2021
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20211124_PBL_06_008_v331_Cure53_report">
November
24th,
2021
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20210419_PBL01_Cure53_report">
October
19th,
2021
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20210210_v3_webextension_issues">
February
10th,
2021
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20191126_autofill_suggestions">
November
26th,
2019
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20190807_multiple_vulnerabilities">
August
7th,
2019
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20190211_multiple_vulnerabilities">
February
11th,
2019
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20181109_gke_incident">
November
9th,
2018
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20180509_nginx_webroot_configuration">
May
9th,
2018
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20180508_password_generator_prng">
May
8th,
2018
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20171228_content_scripts_malicious_domain">
December
28th,
2017
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20171013_passphrase_information_leakage">
October
13th,
2017
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20170914_xss_on_resource_urls">
September
14th,
2017
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20170210_chrome_not_available">
February
10th,
2017
</a>
        </li>
        

    </ul>
</div>

            </div>
            <div class="panel middle" data-spy="scroll" data-target=".scrollspy">
                <div class="grid grid-responsive-12">
                    <article>
                        <div class="row" id="introduction">
    <div class="col12">
        <div class="breadcrumbs">
            <ul>
                <li>
                    <div class="main-cell">
                        <a href="https://www.passbolt.com"><span>home</span></a>
                    </div>
                </li>
                <li>
                    <div class="main-cell">
                        <a href="/"><span>help</span></a>
                    </div>
                </li>
                
                
                <li>
                    <div class="main-cell">
                        <a href="https://help.passbolt.com/incidents"><span>incidents</span></a>
                    </div>
                </li>
                
                
                
                
                <li>
                    <div class="main-cell">
                        <a href="https://help.passbolt.com/incidents/220220118_PBL-06-security-audit-results"><span>PBL-06 Security audit results</span></a>
                    </div>
                </li>
                
            </ul>
        </div>
    </div>
</div>

                        <div class="row" markdown="1">
<div class="col7" markdown="1">
<h1>PBL-06 Security audit results</h1>
</div>
</div>

                        <div class="row">
  <div class="col7">

    <h2 id="introduction">Introduction</h2>

    <p>As part of the security audit of the mobile application, Cure53 team, found 8 issues that have been solved
with v3.5. This audit concerned all the changes related to the implementation of the mobile features for the
API as well as both Android and iOS mobile applications. Additionally, this audit included a review of the community
driven project “<a href="https://github.com/speatzle/go-passbolt-cli">go-passbolt-cli</a>”.</p>

    <p>The issues are only applicable for users participating in the mobile beta, as flagged in the previous incident report 
which targeted release 3.3.1 containing an immediate fix for the only “High” ranked issue.</p>

    <p>All the issues have been fixed or a mitigation has been implemented as of 19th Jan 2022.</p>

    <p>You can read more about the security audit by <a href="/assets/files/PBL-06-report.pdf">reading the full report</a>.</p>

    <p>Passbolt team would like to express a warm thank you to the security researchers from Cure53 team for their collaboration on 
this project. We would also like to thank Samuel Lorch for rolling out fixes promptly for go-passbolt-cli.</p>

    <h2 id="vulnerabilities-summary">Vulnerabilities summary</h2>

    <table class="table-parameters">
  <thead>
    <tr>
      <th>ID</th>
      <th>Project</th>
      <th>Issue name</th>
      <th>Severity</th>
      <th>Status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>PBL-06-001</td>
      <td>Android</td>
      <td>Fingerprint bypass via activity invocation</td>
      <td>Low</td>
      <td>Mitigated (1)</td>
    </tr>
    <tr>
      <td>PBL-06-002</td>
      <td>iOS</td>
      <td>Possible leaks &amp; Phishing via URL scheme hijacking</td>
      <td>Medium</td>
      <td>Fixed in v1.3</td>
    </tr>
    <tr>
      <td>PBL-06-005</td>
      <td>Android</td>
      <td>Account information access via debug messages</td>
      <td>Medium</td>
      <td>Fixed in v1.1</td>
    </tr>
    <tr>
      <td>PBL-06-006</td>
      <td>iOS</td>
      <td>Missing jailbreak detection on iOS</td>
      <td>Medium</td>
      <td>Fixed in v1.3</td>
    </tr>
    <tr>
      <td>PBL-06-007</td>
      <td>Android</td>
      <td>Missing root detection in Android</td>
      <td>Medium</td>
      <td>Fixed in v1.3</td>
    </tr>
    <tr>
      <td>PBL-06-008</td>
      <td>API</td>
      <td>JWT key confusion leads to authentication bypass</td>
      <td>High</td>
      <td>Fixed in v3.3.1</td>
    </tr>
    <tr>
      <td>PBL-06-009</td>
      <td>GO CLI (Community)</td>
      <td>Improper file permissions for configuration file</td>
      <td>High</td>
      <td>Fixed in v0.1.4</td>
    </tr>
    <tr>
      <td>PBL-06-008</td>
      <td>API</td>
      <td>Email HTML injection in JWT attack notifications</td>
      <td>High</td>
      <td>Fixed v3.5</td>
    </tr>
  </tbody>
</table>

    <h3 id="note-pbl-06-001-wp1-fingerprint-bypass-via-activity-invocation-low">(1) Note PBL-06-001 WP1: Fingerprint bypass via activity invocation (LOW)</h3>

    <p>Here are some additional information for the issue marked as mitigated. From the report:</p>

    <p>“The Android app implements a feature whereby the app locks itself when the user switches to another app.
It requires the user to enter the passphrase or the fingerprint in order to continue accessing the authenticated
portion of the application. However, it was found that this feature can be trivially bypassed by invoking the
MainActivity via an ADB command. This finding does not allow the attacker to view the passwords in plain-text and 
it can only be leveraged until the currently allocated JWT token expires (its lifetime from creation is five minutes).”</p>

    <p>According to our test it is not possible to run ADB commands using stock androids. We were able to reproduce the
issue on Lineage OS if the user enable “rooted debugging” in the developer option (which requires pin entry).
Currently, Android passbolt app will display a notification if the device is considered rooted, which includes this flag.
It is the responsibility of the user to either not use a rooted devices or accept the potential issues.</p>

    <p>In Q1 2022 the team will refactor the application to prevent that a fingerprint check can be
bypassed by invoking another activity directly.</p>

    <h3 id="miscellaneous-issues">Miscellaneous issues</h3>

    <p>Additionally, the following issues where reported. While they are not considered as vulnerabilities as such,
they have been reviewed and will be addressed in the future if they are not already fixed.</p>

    <ul>
      <li>PBL-06-003: Android app hardening recommendations (Fixed v1.3)</li>
      <li>PBL-06-004: Android binary hardening recommendations (In review)</li>
      <li>PBL-06-011: Missing ACL checks on TransfersView controller (Fixed v3.5)</li>
      <li>PBL-06-012: URL path traversal via command line flags (<a href="https://github.com/speatzle/go-passbolt/issues/10">Open</a>)</li>
      <li>PBL-06-013: Improper escaping of resource fields (Fixed v0.1.5)</li>
      <li>PBL-06-014: Server packages with known vulnerabilities (Process already in place)</li>
      <li>PBL-06-015: Missing private key revocation process (In backlog)</li>
    </ul>

    <div class="last-updated">
      <h3>Last updated</h3>
      <p>This article was last updated on 
January
19th,
2022.</p>
    </div>

  </div>
  <div class="col4 last push1">
    <div class="tldr message success">
    <h4>Current status:</h4>
    1. Acknowledge issue with reporter<br />
    2. Get a fix/patch prepared<br />
    3. Release new version<br />
    4. Prepare a report about the issue<br />
    <strong>5. Feature the problem in the release</strong>
    <h5>Last updated: 2022-01-19 08:30:00 CET</h5>
</div>
  </div>
</div>

                    </article>
                </div>
            </div>
        </div>
            <footer>
        <div class="footer">
            <ul class="footer-links">
                <li><a href="https://www.passbolt.com/licence">Terms</a></li>
                <li><a href="https://www.passbolt.com/privacy">Privacy</a></li>
                <li><a href="https://www.passbolt.com/credits">Credits</a></li>
                <li><a href="https://careers.passbolt.com">Careers</a></li>
            </ul>
        </div>
    </footer>
    <div id="cookies-eu-banner" class="visually-hidden">
        🍪 &nbsp; Do you accept cookies for statistical purposes?
        <a href="https://www.passbolt.com/privacy" id="cookies-eu-more">(Read more)</a>
        <a class="button primary" id="cookies-eu-accept">Accept</a>
        <a id="cookies-eu-reject">No thanks!</a>
    </div>


    </div>
    <script src="https://consent.cookiebot.com/uc.js" data-cbid="900808a8-f178-4994-b2ad-66bf3ccca5f7" data-blockingmode="auto" strategy="beforeInteractive"></script>
<script src="https://help.passbolt.com/assets/js/matomo-tag-manager.js"></script>
<script src="https://help.passbolt.com/assets/js/matomo-analytics.js"></script>
<script src="https://code.jquery.com/jquery-3.5.0.slim.min.js" integrity="sha384-/IFzzQmt1S744I+IQO4Mc1uphkxbXt1tEwjQ/qSw2p8pXWck09sLvqHmKDYYwReJ" crossorigin="anonymous"></script>
<script src="https://help.passbolt.com/assets/js/analytics.js"></script>
<script src="https://help.passbolt.com/assets/js/greedynav.js"></script>
</body>

</html>