<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Passbolt Help | Pwned Password Service Information Leak Incident</title>
    <!--
             ____                  __          ____
            / __ \____  _____ ____/ /_  ____  / / /_
           / /_/ / __ `/ ___/ ___/ __ \/ __ \/ / __/
          / ____/ /_/ (__  |__  ) /_/ / /_/ / / /_
         /_/    \__,_/____/____/_.___/\____/_/\__/

         Open source password manager for teams
         Â© 2019 Passbolt SA

     -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta property="og:image" content="https://help.passbolt.com/assets/img/background/og_preview.jpg" />
    <meta property="og:title" content="Pwned Password Service Information Leak Incident" />
    <meta property="og:description" content="" />
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/help.min.css">
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/highlight.css">
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/cookie-eu-banner.css">
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/custom.css">
    <link rel="canonical" href="https://help.passbolt.com/incidents/pwned-password-service-information-leak">
    <link rel="shortcut icon" type="image/x-icon" href="https://help.passbolt.com/assets/favicon.ico" />
    <link rel="alternate" type="application/rss+xml" title="Passbolt | Help" href="https://help.passbolt.com/feed.xml">
</head>


<body>
    <div id="container" class="help page background">
            <header>
        <div class="header first ">
            <nav class="greedy">
                <div class="top navigation primary">
                    <ul class="links clearfix">
                        <li class="home with-text"><a href="http://www.passbolt.com/"><span>home</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/services"><span>pricing</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/roadmap"><span>roadmap</span></a></li>
                        <li class="left"><a href="https://community.passbolt.com/"><span>forum</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/blog"><span>blog</span></a></li>
                        <li class="left selected"><a href="https://help.passbolt.com/"><span>help</span></a></li>
                        <li class="left"><a href="https://demo.passbolt.com" class="highlighted" target="_blank" rel="noopener"><span>try it!</span></a></li>
                    </ul>
                    <button class="hidden" count="0">more</button>
                    <ul class="hidden-links hidden"></ul>
                </div>
            </nav>
        </div>
    </header>
    <div class="header second">
        <div class="col1">
            <div class="logo no-img">
                <h1><span>Passbolt</span></h1>
            </div>
        </div>
        <div class="col2 search-wrapper">
            <h2 class="visuallyhidden">Help Search</h2>
            <div>
                <form class="search ready" action="/search.html" method="get">
                    <div class="input required">
                        <label for="search-box">Search</label>
                        <input id="search-box" name="query" maxlength="64" placeholder="Help search" class="fuzzy-search" type="search">
                    </div>
                    <button value="search">
                        <i class="fa fa-fw fa-search"></i>
                        <span class="text visuallyhidden">search</span>
                    </button>
                </form>
            </div>
        </div>
        <div class="col3">
            <div class="edit-on-github">
                <a href="https://github.com/passbolt/passbolt_help/edit/master/_incidents/2024-04-16-pwned-password-service-information-leak.md" class="button">
                    <i class="fa fa-github-alt fa-fw"></i> Edit on github</a>
            </div>
        </div>
    </div>

        <div class="panel main" aria-label="Content">
            <div class="panel left">
                <div class="navigation-help" role="navigation">
    <ul>
        <li><h2>Incidents</h2></li>

        
        <li>
        
            <a href="/incidents">All incidents</a>
        </li>

        
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/reflective-html-injection-vulnerability">
April
16th,
2024
</a>
        </li>
        
        
        <li class="selected">
        
            <a href="https://help.passbolt.com/incidents/pwned-password-service-information-leak">
April
16th,
2024
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20240415_PBL-11-security-audit-results">
April
15th,
2024
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20230911_PBL-09-security-audit-results">
September
11th,
2023
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20230710_PBL-08-security-audit-results">
July
10th,
2023
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20230701_cloud-outage">
July
3rd,
2023
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20230426_sending-unencrypted-description">
April
26th,
2023
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20230404_android-app-unlisted">
April
5th,
2023
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20220920_spell-jacking">
September
20th,
2022
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/220220118_PBL-06-security-audit-results">
January
19th,
2022
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/220211215_Clout-outage">
December
15th,
2021
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20211124_PBL_06_008_v331_Cure53_report">
November
24th,
2021
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20210419_PBL01_Cure53_report">
October
19th,
2021
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20210210_v3_webextension_issues">
February
10th,
2021
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20191126_autofill_suggestions">
November
26th,
2019
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20190807_multiple_vulnerabilities">
August
7th,
2019
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20190211_multiple_vulnerabilities">
February
11th,
2019
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20181109_gke_incident">
November
9th,
2018
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20180509_nginx_webroot_configuration">
May
9th,
2018
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20180508_password_generator_prng">
May
8th,
2018
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20171228_content_scripts_malicious_domain">
December
28th,
2017
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20171013_passphrase_information_leakage">
October
13th,
2017
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20170914_xss_on_resource_urls">
September
14th,
2017
</a>
        </li>
        
        
        <li>
        
            <a href="https://help.passbolt.com/incidents/20170210_chrome_not_available">
February
10th,
2017
</a>
        </li>
        

    </ul>
</div>

            </div>
            <div class="panel middle" data-spy="scroll" data-target=".scrollspy">
                <div class="grid grid-responsive-12">
                    <article>
                        <div class="row" id="introduction">
    <div class="col12">
        <div class="breadcrumbs">
            <ul>
                <li>
                    <div class="main-cell">
                        <a href="https://www.passbolt.com"><span>home</span></a>
                    </div>
                </li>
                <li>
                    <div class="main-cell">
                        <a href="/"><span>help</span></a>
                    </div>
                </li>
                
                
                <li>
                    <div class="main-cell">
                        <a href="https://help.passbolt.com/incidents"><span>incidents</span></a>
                    </div>
                </li>
                
                
                
                
                <li>
                    <div class="main-cell">
                        <a href="https://help.passbolt.com/incidents/pwned-password-service-information-leak"><span>pwned-password-service-information-leak</span></a>
                    </div>
                </li>
                
            </ul>
        </div>
    </div>
</div>

                        <div class="row" markdown="1">
<div class="col7" markdown="1">
<h1>Pwned Password Service Information Leak Incident</h1>
</div>
</div>

                        <div class="row">
  <div class="col7">

    <h2 id="introduction">Introduction</h2>

    <p>A vulnerability identified by security researchers of Quarkslab, could result in an information leak. 
This vulnerability would have allowed an attacker capable of observing Passbolt browser extension queries to the
Pwned Password API to more easily bruteforce and therefore guess manually entered passwords.</p>

    <ul>
      <li><strong>CVSS Score</strong>: <a href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:N/A:N/E:P/RL:O/RC:C">5.5 (Medium)</a></li>
      <li><strong>CVE</strong>: In progress</li>
      <li><strong>Vulnerability Type</strong>: Information leak</li>
      <li><strong>Product affected</strong>: Browser extension, Windows app</li>
      <li><strong>Versions affected</strong>: Browser extension &lt;= v4.6.0, Windows application &lt;= v0.6</li>
      <li><strong>Version fixed</strong>: Browser extension v4.6.2, Windows app v1.0</li>
      <li><strong>Affected component</strong>: Password strength validation component</li>
    </ul>

    <h2 id="who-is-impacted">Who is impacted</h2>

    <p>The primary technical prerequisite for exploiting this vulnerability involves the ability to monitor the 
queries made by the Passbolt clients to the Pwned Password API.</p>

    <p>Therefore, users whose TLS traffic could be intercepted (e.g. decrypted and recorded), such as users having 
installed a corporate certificate authority on their devices by their organizations, are susceptible to this 
vulnerability. Additionally, entities like Cloudflare, which significantly cache Pwned Passwords queries, 
would have the capability to exploit the vulnerability.</p>

    <p>Passwords generated using the password generators are not affected by this vulnerability. Passwords created 
manually that are under 8 characters are not affected.</p>

    <p>It is also important to note that an attacker capable of guessing a user passphrase using this vulnerability 
would not be able to access or decrypt secrets stored in passbolt, as they do not have access to user randomly 
generated private keys.</p>

    <h2 id="vulnerability-details">Vulnerability details</h2>
    <p>The pwned password service is used across various password-related processes to prevent users from reusing 
passwords that have been exposed in data breaches. The issue arises from passbolt specific implementation, 
which may query the API multiple times for when it is manually entered by the user as soon as the credential 
is above 8 characters. While a 300ms debounce of the user keyboard event was in place, it does not necessarily
reflect the typing speed of users.</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://api.pwnedpasswords.com/range/01b30
https://api.pwnedpasswords.com/range/c44b9
https://api.pwnedpasswords.com/range/ff998
</code></pre></div>    </div>

    <p>For example, with a password like 1234567890abcdef, Passbolt might make several queries to the pwned password 
service, depending on the speed at which the user types. To deduce the entire password, an attacker would first 
need to infer intermediate passwords hashes, by instance 01b30 for 1234567890 and c44b9 for 1234567890abc, 
which are simpler to guess. Each intermediary guess narrows down the possible options for guessing subsequent 
intermediate hashes.</p>

    <p>For more details on the vulnerability, including proof of concept, we invite you to read the <a href="https://blog.quarkslab.com/passbolt-a-bold-use-of-haveibeenpwned.html">original report</a> 
on Quarkslab blog.</p>

    <h2 id="mitigation-and-remediations">Mitigation and remediations</h2>
    <p>A fix was rolled out with Passbolt browser extension v4.6.2 (between the 30th of march and 4th of April, 
depending on the browser). Since Passbolt v4.6.2 a limit was introduced to use the pwned password service 
only on form submission and only if the password is above the weak entropy (60 bits).</p>

    <p>Administrators, if this attack scenario is part of their threat model, are invited to:</p>
    <ul>
      <li>Rotate passwords that were selected and entered manually.</li>
      <li>Rotate users passphrases</li>
    </ul>

    <p>Additionally for organizations intercepting TLS traffic of their users, it is recommended to flush logs that could 
include pwned password service hashes traces.</p>

    <p>Additionally for organizations, using the Pro or the Cloud, which would not trust third party services involved in 
the process such as Cloudflare or pwned passwords, it would be recommended to disable the data breach check from 
the administrationâs settings (User passphrase policies and password policies). In the future we will introduce 
a new administration page to regroup all these settings and make them available in all versions under one section.</p>

    <h2 id="acknowledgments">Acknowledgments</h2>
    <p>Passbolt would like to acknowledge the security researchers from Quarkslab for their vital role in uncovering 
and reporting the vulnerability. We extend our thanks to Quarkslab for their seamless incident response coordination.</p>

    <p>We would also like to thank Cure53 for performing an independent 3rd party assessment of this vulnerability report.</p>

    <h2 id="timeline-of-events">Timeline of events</h2>

    <ul>
      <li>2024-03-22: Vulnerability reported by security researchers</li>
      <li>2024-03-23: Vulnerability acknowledged to security researchers</li>
      <li>2024-03-25: Passbolt development team start working on a fix</li>
      <li>2024-03-28: Fix published on repository, extension submitted for review in webstore</li>
      <li>2024-03-29: Chrome extension RC v4.6.2 extension published</li>
      <li>2024-03-30: Chrome extension v4.6.2 published</li>
      <li>2024-04-03: Firefox extension v4.6.2 published</li>
      <li>2024-04-04: Edge extension v4.6.2 published</li>
      <li>2024-04-11: Windows application v1.0 pushed</li>
      <li>2024-04-16: CVE requested</li>
      <li>2024-04-17: Incident page published</li>
    </ul>

    <div class="last-updated">
      <h3>Last updated</h3>
      <p>This article was last updated on 
April
16th,
2024.</p>
    </div>

  </div>
  <div class="col4 last push1">
    <div class="message notice">
    <h2>External references</h2>
    <p>For more details on the vulnerability, including proof of concept, we invite you to read the original report.</p>
    <a class="button" href="https://blog.quarkslab.com/passbolt-a-bold-use-of-haveibeenpwned.html">Quarkslab Blog</a>
</div>

    <div class="message success">
    <h4>Current status:</h4>
    1. Try first to reproduce the issue<br />
    2. Acknowledge to the reporter<br />
    3. Get a fix/patch prepared<br />
    4. Release new version.<br />
    5. Prepare a report about the issue.<br />
    <strong>6. Feature the problem in an incident page.</strong>
    <h5>Last updated: 2017-09-17 09:30:00 CET</h5>
</div>

  </div>
</div>

                    </article>
                </div>
            </div>
        </div>
            <footer>
        <div class="footer">
            <ul class="footer-links">
                <li><a href="https://www.passbolt.com/licence">Terms</a></li>
                <li><a href="https://www.passbolt.com/privacy">Privacy</a></li>
                <li><a href="https://www.passbolt.com/credits">Credits</a></li>
                <li><a href="https://careers.passbolt.com">Careers</a></li>
            </ul>
        </div>
    </footer>
    <div id="cookies-eu-banner" class="visually-hidden">
        ðª &nbsp; Do you accept cookies for statistical purposes?
        <a href="https://www.passbolt.com/privacy" id="cookies-eu-more">(Read more)</a>
        <a class="button primary" id="cookies-eu-accept">Accept</a>
        <a id="cookies-eu-reject">No thanks!</a>
    </div>


    </div>
    <script src="https://consent.cookiebot.com/uc.js" data-cbid="900808a8-f178-4994-b2ad-66bf3ccca5f7" data-blockingmode="auto" strategy="beforeInteractive"></script>
<script src="https://help.passbolt.com/assets/js/matomo-tag-manager.js"></script>
<script src="https://help.passbolt.com/assets/js/matomo-analytics.js"></script>
<script src="https://code.jquery.com/jquery-3.5.0.slim.min.js" integrity="sha384-/IFzzQmt1S744I+IQO4Mc1uphkxbXt1tEwjQ/qSw2p8pXWck09sLvqHmKDYYwReJ" crossorigin="anonymous"></script>
<script src="https://help.passbolt.com/assets/js/analytics.js"></script>
<script src="https://help.passbolt.com/assets/js/greedynav.js"></script>
</body>

</html>