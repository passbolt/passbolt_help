<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Passbolt Help | Docker install</title>
    <!--
             ____                  __          ____
            / __ \____  _____ ____/ /_  ____  / / /_
           / /_/ / __ `/ ___/ ___/ __ \/ __ \/ / __/
          / ____/ /_/ (__  |__  ) /_/ / /_/ / / /_
         /_/    \__,_/____/____/_.___/\____/_/\__/

         Open source password manager for teams
         ¬© 2019 Passbolt SA

     -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta property="og:image" content="https://help.passbolt.com/assets/img/background/og_preview.jpg" />
    <meta property="og:title" content="Docker install" />
    <meta property="og:description" content="" />
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/help.min.css">
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/highlight.css">
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/cookie-eu-banner.css">
    <link rel="canonical" href="https://help.passbolt.com/hosting/install/pro/docker">
    <link rel="shortcut icon" type="image/x-icon" href="https://help.passbolt.com/assets/favicon.ico" />
    <link rel="alternate" type="application/rss+xml" title="Passbolt | Help" href="https://help.passbolt.com/feed.xml">

</head>


<body>
    <div id="container" class="help page background">
            <header>
        <div class="header first ">
            <nav class="greedy">
                <div class="top navigation primary">
                    <ul class="links clearfix">
                        <li class="home with-text"><a href="http://www.passbolt.com/"><span>home</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/services"><span>pricing</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/roadmap"><span>roadmap</span></a></li>
                        <li class="left"><a href="https://community.passbolt.com/"><span>forum</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/blog"><span>blog</span></a></li>
                        <li class="left selected"><a href="https://help.passbolt.com/"><span>help</span></a></li>
                        <li class="left"><a href="https://demo.passbolt.com" class="highlighted" target="_blank" rel="noopener"><span>try it!</span></a></li>
                    </ul>
                    <button class="hidden" count="0">more</button>
                    <ul class="hidden-links hidden"></ul>
                </div>
            </nav>
        </div>
    </header>
    <div class="header second">
        <div class="col1">
            <div class="logo no-img">
                <h1><span>Passbolt</span></h1>
            </div>
        </div>
        <div class="col2 search-wrapper">
            <h2 class="visuallyhidden">Help Search</h2>
            <div>
                <form class="search ready" action="/search.html" method="get">
                    <div class="input required">
                        <label for="search-box">Search</label>
                        <input id="search-box" name="query" maxlength="64" placeholder="Help search" class="fuzzy-search" type="search">
                    </div>
                    <button value="search">
                        <i class="fa fa-fw fa-search"></i>
                        <span class="text visuallyhidden">search</span>
                    </button>
                </form>
            </div>
        </div>
        <div class="col3">
            <div class="edit-on-github">
                <a href="https://github.com/passbolt/passbolt_help/edit/master/_posts/hosting/installation/2018-04-04-hosting-install-docker-pro.md" class="button">
                    <i class="fa fa-github-alt fa-fw"></i> Edit on github</a>
            </div>
        </div>
    </div>

        <div class="panel main" aria-label="Content">
            <div class="panel left">
                
                







<div class="navigation-help" role="navigation">
    <ul>
        <li>
            <h2>Hosting</h2>
        </li>
        
        <li >
            <a href="https://help.passbolt.com/faq/hosting">Hosting FAQ</a>
        </li>
        
        
        <li >
            <a href="https://help.passbolt.com/hosting/install">Installation</a>
        </li>
        
        
        
        
        <li >
            <a href="https://help.passbolt.com/hosting/update">Update</a>
        </li>
        
        
        <li >
            <a href="https://help.passbolt.com/hosting/upgrade">Upgrade</a>
        </li>
        
        
        <li >
            <a href="https://help.passbolt.com/hosting/backup">Backup</a>
        </li>
        
        
        <li >
            <a href="https://community.passbolt.com/c/installation-issues">Installation issues</a>
        </li>
        
        
    </ul>
</div>










                
            </div>
            <div class="panel middle" data-spy="scroll" data-target=".scrollspy">
                <div class="grid grid-responsive-12">
                    <article>
                        <div class="row" id="introduction">
    <div class="col12">
        <div class="breadcrumbs">
            <ul>
                <li>
                    <div class="main-cell">
                        <a href="https://www.passbolt.com"><span>home</span></a>
                    </div>
                </li>
                <li>
                    <div class="main-cell">
                        <a href="/"><span>help</span></a>
                    </div>
                </li>
                
                
                <li>
                    <div class="main-cell">
                        <a href="https://help.passbolt.com/hosting"><span>hosting</span></a>
                    </div>
                </li>
                <li>
                    <div class="main-cell">
                        <a href="https://help.passbolt.com/hosting/install"><span>install</span></a>
                    </div>
                </li>
                
                
                
                <li>
                    <div class="main-cell">
                        <a href="https://help.passbolt.com/hosting/install/pro/docker.html"><span>docker</span></a>
                    </div>
                </li>
                
            </ul>
        </div>
    </div>
</div>

                        <div class="row" markdown="1">
<div class="col7" markdown="1">
<h1>Docker install</h1>
</div>
</div>

                        <div class="row">
  <div class="col7">

    <h2 id="system-requirements">System requirements</h2>

    <ul>
      <li>Docker CE</li>
    </ul>

    <h2 id="optional-system-requirements">Optional system requirements</h2>

    <ul>
      <li>MySQL &lt; 8.x or MariaDB as separated containers or host installation.</li>
      <li>docker-compose if you plan to use a docker-compose.yml file to run passbolt container.</li>
      <li>rng-tools/haveged for faster filling of container entropy pool. These tools come handy in cases where GnuPG complains about no entropy is available to perform some operation (generate keys, encrypt, sign‚Ä¶) inside the docker container. <a href="https://security.stackexchange.com/questions/39992/is-it-safe-to-use-rng-tools-on-a-virtual-machine">Important considerations</a></li>
    </ul>

    <h2 id="getting-passbolt-container">Getting passbolt container</h2>

    <p>Passbolt containers follow the following tagging:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;version_number&gt;-&lt;build_number&gt;-pro-debian
</code></pre></div>    </div>

    <p>Nobody is perfect so we also provide a  <em>latest</em> tag for Passbolt containers. Through all this documentation pages we make use of the latest tag so users will get the last version of passbolt.
However, it is recommended that users pull the tags pointing to specific passbolt versions when running in environments other than testing.</p>

    <p>Get passbolt Pro latest docker container:</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker pull passbolt/passbolt:latest-pro
</code></pre></div>    </div>

    <h2 id="option-1-using-docker-compose">Option 1. Using docker-compose</h2>

    <p>From the docker-compose official docs: ‚ÄòCompose is a tool for defining and running multi-container Docker applications‚Äô</p>

    <p>Passbolt provides a <a href="https://github.com/passbolt/passbolt_docker/blob/master/docker-compose-pro.yml">docker-compose-pro.yml</a> file. That users can download and use with docker-compose.
The easiest way to use passbolt provided docker-compose-pro.yml is to:</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>git clone https://github.com/passbolt/passbolt_docker
<span class="nv">$ </span><span class="nb">cp </span>your_subscription_license_file passbolt_docker/license
<span class="nv">$ </span><span class="nb">cd </span>passbolt_docker
</code></pre></div>    </div>

    <p>At this point some users might want to customize passbolt environment variables and change the fullBaseUrl for instance. Environment variables are defined in the following files:</p>
    <ul>
      <li>env/mysql.env</li>
      <li>env/passbolt.env</li>
    </ul>

    <p>Once the files fit your needs it is time to:</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker-compose <span class="nt">-f</span> docker-compose-pro.yml up
</code></pre></div>    </div>

    <h3 id="create-first-admin-user-using-docker-compose">Create first admin user using docker-compose</h3>

    <p>If you run passbolt using <a href="https://github.com/passbolt/passbolt_docker/blob/master/docker-compose-pro.yml">docker-compose-pro.yml</a> provided by passbolt:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker-compose <span class="nb">exec </span>passbolt su <span class="nt">-m</span> <span class="nt">-c</span> <span class="s2">"/var/www/passbolt/bin/cake </span><span class="se">\</span><span class="s2">
                                passbolt register_user </span><span class="se">\</span><span class="s2">
                                -u &lt;your@email.com&gt; </span><span class="se">\</span><span class="s2">
                                -f &lt;yourname&gt; </span><span class="se">\</span><span class="s2">
                                -l &lt;surname&gt; </span><span class="se">\</span><span class="s2">
                                -r admin"</span> <span class="nt">-s</span> /bin/sh www-data
</code></pre></div>    </div>

    <h2 id="option-2-using-passbolt-container">Option 2. Using passbolt container</h2>

    <p>Passbolt requires a database backend to store the information. In this section we will be using a MariaDB database packaged as a docker container.</p>

    <p>A subscription key file is also required to use Passbolt Pro. You can get the subscription key <a href="https://www.passbolt.com/">here</a></p>

    <div class="message warning">
    <p>
        <strong>Please note:</strong> Passbolt uses Mariadb/MySQL as a storage backend for encrypted passwords. It is mandatory to persist <code class="language-plaintext highlighter-rouge">/var/lib/mysql</code>
if you are running Mariadb/MySQL on a docker container to avoid data loss when restarting such containers.
    </p>
    
</div>

    <h3 id="manually-run-passbolt-container-and-mariadb-container">Manually run passbolt container and mariadb container</h3>

    <p>It is recommended to create a user defined network to ease the container name resolution. Using a user defined network will provide a method to access containers using their names instead ip addresses:</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker network create passbolt_network
</code></pre></div>    </div>

    <p>First run the mariadb container:</p>

    <p>As we want all the data in mariadb to survive container restarts it is recommended to create either a docker
volume or a host directory and mount it at <code class="language-plaintext highlighter-rouge">/var/lib/mysql</code></p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker volume create mariadb_passbolt_data
<span class="nv">$ </span>docker run <span class="nt">-d</span> <span class="nt">--name</span> mariadb <span class="nt">--net</span> passbolt_network <span class="se">\</span>
             <span class="nt">--mount</span> <span class="nb">source</span><span class="o">=</span>mariadb_passbolt_data,target<span class="o">=</span>/var/lib/mysql <span class="se">\</span>
             <span class="nt">-e</span> <span class="nv">MYSQL_ROOT_PASSWORD</span><span class="o">=</span>&lt;root_password&gt; <span class="se">\</span>
             <span class="nt">-e</span> <span class="nv">MYSQL_DATABASE</span><span class="o">=</span>&lt;mariadb_database&gt; <span class="se">\</span>
             <span class="nt">-e</span> <span class="nv">MYSQL_USER</span><span class="o">=</span>&lt;mariadb_user&gt; <span class="se">\</span>
             <span class="nt">-e</span> <span class="nv">MYSQL_PASSWORD</span><span class="o">=</span>&lt;mariadb_password&gt; <span class="se">\</span>
             mariadb
</code></pre></div>    </div>

    <p>Now we can run the passbolt container:</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker run <span class="nt">--name</span> passbolt-pro <span class="nt">--net</span> passbolt_network <span class="se">\</span>
             <span class="nt">--mount</span> <span class="nb">type</span><span class="o">=</span><span class="nb">bind</span>,<span class="se">\</span>
               <span class="nb">source</span><span class="o">=</span>&lt;host_path_to_gnupg_keys_dir&gt;,<span class="se">\</span>
               <span class="nv">target</span><span class="o">=</span>/var/www/passbolt/config/gpg <span class="se">\</span>
             <span class="nt">--mount</span> <span class="nb">type</span><span class="o">=</span><span class="nb">bind</span>,<span class="se">\</span>
               <span class="nb">source</span><span class="o">=</span>&lt;path_subscription&gt;,<span class="se">\</span>
               <span class="nv">target</span><span class="o">=</span>/var/www/passbolt/config/license <span class="se">\</span>
             <span class="nt">-p</span> 443:443 <span class="se">\</span>
             <span class="nt">-p</span> 80:80 <span class="se">\</span>
             <span class="nt">-e</span> <span class="nv">DATASOURCES_DEFAULT_HOST</span><span class="o">=</span>mariadb <span class="se">\</span>
             <span class="nt">-e</span> <span class="nv">DATASOURCES_DEFAULT_PASSWORD</span><span class="o">=</span>&lt;mariadb_password&gt; <span class="se">\</span>
             <span class="nt">-e</span> <span class="nv">DATASOURCES_DEFAULT_USERNAME</span><span class="o">=</span>&lt;mariadb_user&gt; <span class="se">\</span>
             <span class="nt">-e</span> <span class="nv">DATASOURCES_DEFAULT_DATABASE</span><span class="o">=</span>&lt;mariadb_database&gt; <span class="se">\</span>
             <span class="nt">-e</span> <span class="nv">APP_FULL_BASE_URL</span><span class="o">=</span>https://mydomain.com <span class="se">\</span>
             passbolt/passbolt:latest-pro
</code></pre></div>    </div>

    <p>Note: strings between ‚Äò&lt;‚Äô and ‚Äò&gt;‚Äô are variables that the users should fill with their data.</p>

    <p>Passbolt require some data to be persistant, most notably the OpenPGP server keys. But also the images, 
and potentially the SSL certificate. You can read more about it bellow.</p>

    <h3 id="persisting-data-in-passbolt-container">Persisting data in passbolt container</h3>

    <p>There are several locations that might be interesting for the users to persist data between container restarts:</p>
    <ul>
      <li>Images directory: /var/www/passbolt/webroot/img</li>
      <li>Gnupg serverkeys directory: /var/www/passbolt/config/gpg</li>
      <li>
        <p>SSL certificate files: /etc/ssl/certs/certificate.crt /etc/ssl/certs/certificate.key</p>
      </li>
      <li>Subscription key file: /var/www/passbolt/config/license</li>
    </ul>

    <p>This files and directories can be persisted in the docker volume using <a href="https://docs.docker.com/storage/volumes/">docker volumes</a> or using <a href="https://docs.docker.com/storage/bind-mounts/#start-a-container-with-a-bind-mount">bind mounts</a></p>

    <h3 id="examples">Examples</h3>

    <p>An example for persisting the images directory could be to create a docker volume:</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker volume create passbolt_images
</code></pre></div>    </div>

    <p>And run passbolt container with the previously created volume:</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker run <span class="nt">--name</span> passbolt-pro <span class="nt">--net</span> passbolt_network <span class="se">\</span>
             <span class="nt">--mount</span> <span class="nb">source</span><span class="o">=</span>passbolt_images,<span class="se">\</span>
             <span class="nv">target</span><span class="o">=</span>/var/www/passbolt/webroot/img <span class="se">\</span>
             <span class="nt">--mount</span> <span class="nb">type</span><span class="o">=</span><span class="nb">bind</span>,<span class="se">\</span>
               <span class="nb">source</span><span class="o">=</span>&lt;path_subscription&gt;,<span class="se">\</span>
               <span class="nv">target</span><span class="o">=</span>/var/www/passbolt/config/license <span class="se">\</span>
             <span class="nt">-p</span> 443:443 <span class="se">\</span>
             <span class="nt">-p</span> 80:80 <span class="se">\</span>
             <span class="nt">-e</span> <span class="nv">DATASOURCES_DEFAULT_HOST</span><span class="o">=</span>mariadb <span class="se">\</span>
             <span class="nt">-e</span> <span class="nv">DATASOURCES_DEFAULT_PASSWORD</span><span class="o">=</span>&lt;mariadb_password&gt; <span class="se">\</span>
             <span class="nt">-e</span> <span class="nv">DATASOURCES_DEFAULT_USERNAME</span><span class="o">=</span>&lt;mariadb_user&gt; <span class="se">\</span>
             <span class="nt">-e</span> <span class="nv">DATASOURCES_DEFAULT_DATABASE</span><span class="o">=</span>&lt;mariadb_database&gt; <span class="se">\</span>
             <span class="nt">-e</span> <span class="nv">APP_FULL_BASE_URL</span><span class="o">=</span>https://mydomain.com <span class="se">\</span>
             passbolt/passbolt:latest-pro
</code></pre></div>    </div>

    <p>Bind volumes are usually useful when, for instance, the SSL certificates or GnuPG keys have been already created in the host machine:</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker run <span class="nt">--name</span> passbolt <span class="nt">--net</span> passbolt_network <span class="se">\</span>
             <span class="nt">--mount</span> <span class="nb">type</span><span class="o">=</span><span class="nb">bind</span>,<span class="se">\</span>
               <span class="nb">source</span><span class="o">=</span>&lt;host_path_to_gnupg_keys_dir&gt;,<span class="se">\</span>
               <span class="nv">target</span><span class="o">=</span>/var/www/passbolt/config/gpg <span class="se">\</span>
             <span class="nt">--mount</span> <span class="nb">type</span><span class="o">=</span><span class="nb">bind</span>,<span class="se">\</span>
               <span class="nb">source</span><span class="o">=</span>&lt;path_subscription&gt;,<span class="se">\</span>
               <span class="nv">target</span><span class="o">=</span>/var/www/passbolt/config/license <span class="se">\</span>
             <span class="nt">-p</span> 443:443 <span class="se">\</span>
             <span class="nt">-p</span> 80:80 <span class="se">\</span>
             <span class="nt">-e</span> <span class="nv">DATASOURCES_DEFAULT_HOST</span><span class="o">=</span>mariadb <span class="se">\</span>
             <span class="nt">-e</span> <span class="nv">DATASOURCES_DEFAULT_PASSWORD</span><span class="o">=</span>&lt;mariadb_password&gt; <span class="se">\</span>
             <span class="nt">-e</span> <span class="nv">DATASOURCES_DEFAULT_USERNAME</span><span class="o">=</span>&lt;mariadb_user&gt; <span class="se">\</span>
             <span class="nt">-e</span> <span class="nv">DATASOURCES_DEFAULT_DATABASE</span><span class="o">=</span>&lt;mariadb_database&gt; <span class="se">\</span>
             <span class="nt">-e</span> <span class="nv">APP_FULL_BASE_URL</span><span class="o">=</span>https://mydomain.com <span class="se">\</span>
             passbolt/passbolt:latest-pro
</code></pre></div>    </div>

    <p>An example of the above using docker-compose can be found <a href="https://github.com/passbolt/passbolt_docker/blob/master/docker-compose-pro.yml">here</a> where bind mounts and volumes are used.</p>

    <p>NOTE: If you dont provide any GnuPG severkey or SSL certificate passbolt container will create a self signed SSL certificate and a GnuPG server key pair.</p>

    <h3 id="manually-creating-first-admin-user">Manually creating first admin user</h3>

    <p>Once the passbolt container is up and running use this command to generate the first admin user:</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker <span class="nb">exec </span>passbolt-pro su <span class="nt">-m</span> <span class="nt">-c</span> <span class="s2">"/var/www/passbolt/bin/cake </span><span class="se">\</span><span class="s2">
                                passbolt register_user </span><span class="se">\</span><span class="s2">
                                -u &lt;your@email.com&gt; </span><span class="se">\</span><span class="s2">
                                -f &lt;yourname&gt; </span><span class="se">\</span><span class="s2">
                                -l &lt;surname&gt; </span><span class="se">\</span><span class="s2">
                                -r admin"</span> <span class="nt">-s</span> /bin/sh www-data
</code></pre></div>    </div>

    <p>It will output a link similar to the below one that can be pasted on the browser to finalize user registration:</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://mydomain.com/setup/install/1eafab88-a17d-4ad8-97af-77a97f5ff552/f097be64-3703-41e2-8ea2-d59cbe1c15bc
</code></pre></div>    </div>

    <h2 id="more-information-on-environment-variables">More information on environment variables</h2>
    <p>For more information on which environment variables are available on Passbolt, please check the
<a href="/configure/environment/reference.html">passbolt env variable reference</a></p>

    <div class="last-updated">
      <h3>Last updated</h3>
      <p>This article was last updated on 
April
9th,
2018.</p>
    </div>

  </div>
  <div class="col4 last push1">

    <div class="message tldr notice">
    <p>Are you experiencing issues with Passbolt Pro Edition?</p>
    <a href="mailto:contact@passbolt.com" class="button primary">Contact Pro support</a>
    <p>or <a href="https://community.passbolt.com">ask the community</a></p>

</div>

  </div>
</div>

                    </article>
                </div>
            </div>
        </div>
            <footer>
        <div class="footer">
            <ul class="footer-links">
                <li><a href="https://www.passbolt.com/licence">Terms</a></li>
                <li><a href="https://www.passbolt.com/privacy">Privacy</a></li>
                <li><a href="https://www.passbolt.com/credits">Credits</a></li>
                <li><a href="https://careers.passbolt.com">Careers</a></li>
            </ul>
        </div>
    </footer>
    <div id="cookies-eu-banner" class="visually-hidden">
        üç™ &nbsp; Do you accept cookies for statistical purposes?
        <a href="https://www.passbolt.com/privacy" id="cookies-eu-more">(Read more)</a>
        <a class="button primary" id="cookies-eu-accept">Accept</a>
        <a id="cookies-eu-reject">No thanks!</a>
    </div>


    </div>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-23506466-3"></script>
<script src="https://code.jquery.com/jquery-3.5.0.slim.min.js" integrity="sha384-/IFzzQmt1S744I+IQO4Mc1uphkxbXt1tEwjQ/qSw2p8pXWck09sLvqHmKDYYwReJ" crossorigin="anonymous"></script>
<script src="https://help.passbolt.com/assets/js/cookies-eu-banner.js"></script>
<script src="https://help.passbolt.com/assets/js/analytics.js"></script>
<script src="https://help.passbolt.com/assets/js/greedynav.js"></script>
</body>

</html>