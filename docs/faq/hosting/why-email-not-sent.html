<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Passbolt Help | Why are my emails not being sent?</title>
    <!--
             ____                  __          ____
            / __ \____  _____ ____/ /_  ____  / / /_
           / /_/ / __ `/ ___/ ___/ __ \/ __ \/ / __/
          / ____/ /_/ (__  |__  ) /_/ / /_/ / / /_
         /_/    \__,_/____/____/_.___/\____/_/\__/

         Open source password manager for teams
         ¬© 2019 Passbolt SA

     -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="This can come from a variety of reasons, here are the most common ones.">
    <meta property="og:image" content="https://help.passbolt.com/assets/img/background/og_preview.jpg" />
    <meta property="og:title" content="Why are my emails not being sent?" />
    <meta property="og:description" content="This can come from a variety of reasons, here are the most common ones." />
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/help.min.css">
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/highlight.css">
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/cookie-eu-banner.css">
    <link rel="canonical" href="https://help.passbolt.com/faq/hosting/why-email-not-sent">
    <link rel="shortcut icon" type="image/x-icon" href="https://help.passbolt.com/assets/favicon.ico" />
    <link rel="alternate" type="application/rss+xml" title="Passbolt | Help" href="https://help.passbolt.com/feed.xml">

</head>

<body>
<div id="container" class="help page background">
    <header>
        <div class="header first ">
            <nav class="greedy">
                <div class="top navigation primary">
                    <ul class="links clearfix">
                        <li class="home with-text"><a href="http://www.passbolt.com/"><span>home</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/services"><span>pricing</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/roadmap"><span>roadmap</span></a></li>
                        <li class="left"><a href="https://community.passbolt.com/"><span>forum</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/blog"><span>blog</span></a></li>
                        <li class="left selected"><a href="https://help.passbolt.com/"><span>help</span></a></li>
                        <li class="left"><a href="https://demo.passbolt.com" class="highlighted" target="_blank" rel="noopener"><span>try it!</span></a></li>
                    </ul>
                    <button class="hidden" count="0">more</button>
                    <ul class="hidden-links hidden"></ul>
                </div>
            </nav>
        </div>
    </header>
    <div class="header second">
        <div class="col1">
            <div class="logo no-img">
                <h1><span>Passbolt</span></h1>
            </div>
        </div>
        <div class="col2 search-wrapper">
            <h2 class="visuallyhidden">Help Search</h2>
            <div>
                <form class="search ready" action="/search.html" method="get">
                    <div class="input required">
                        <label for="search-box">Search</label>
                        <input id="search-box" name="query" maxlength="64" placeholder="Help search" class="fuzzy-search" type="search">
                    </div>
                    <button value="search">
                        <i class="fa fa-fw fa-search"></i>
                        <span class="text visuallyhidden">search</span>
                    </button>
                </form>
            </div>
        </div>
        <div class="col3">
            <div class="edit-on-github">
                <a href="https://github.com/passbolt/passbolt_help/edit/master/_faq/hosting/002-why-are-my-email-not-being-sent.md" class="button">
                    <i class="fa fa-github-alt fa-fw"></i> Edit on github</a>
            </div>
        </div>
    </div>


    <div class="panel main" aria-label="Content">
        <div class="panel left">
            <div class="navigation-help" role="navigation">
    <ul>
        <li><h2>All FAQs</h2></li>
        

        
        <li>
        
            <a href="https://help.passbolt.com/faq/discover">Discover</a>
        </li>
        

        
        <li>
        
            <a href="https://help.passbolt.com/faq/start">Get started</a>
        </li>
        

        
        <li class="selected">
        
            <a href="https://help.passbolt.com/faq/hosting">Hosting</a>
        </li>
        

        
        <li>
        
            <a href="https://help.passbolt.com/faq/contribute">Contribute</a>
        </li>
        

        
        <li>
        
            <a href="https://help.passbolt.com/faq/security">Security</a>
        </li>
        

        
        <li>
        
            <a href="https://help.passbolt.com/faq/legal">Legal</a>
        </li>
        
    </ul>
</div>

        </div>
        <div class="panel middle" data-spy="scroll" data-target=".scrollspy">
            <div class="grid grid-responsive-12">
                <article>
                    <div class="row" id="introduction">
    <div class="col12">
        <div class="breadcrumbs">
            <ul>
                <li>
                    <div class="main-cell">
                        <a href="https://www.passbolt.com"><span>home</span></a>
                    </div>
                </li>
                <li>
                    <div class="main-cell">
                        <a href="https://help.passbolt.com"><span>help</span></a>
                    </div>
                </li>
                <li>
                    <div class="main-cell">
                        <a href="https://help.passbolt.com/faq"><span>FAQ</span></a>
                    </div>
                </li>
                <li>
                    <div class="main-cell">
                        <a href=""><span>Why are my emails not being sent?</span></a>
                    </div>
                </li>
            </ul>
        </div>
    </div>
</div>


                    <div class="row" markdown="1">
                        <div class="col7" markdown="1">
                         <h1>Why are my emails not being sent?</h1>
                            <p>This can come from a variety of reasons, here are the most common ones.</p>

<h3 id="reason-1-configuration-issues">Reason 1: Configuration issues</h3>

<p>There may be an issue with some of the <a href="/configure/email/setup">SMTP configuration</a>
items, such as credentials, or the hostname, or the port for the selected protocol.</p>

<p>By default passbolt is quite discrete on why a given configuration is not working. You can use the following
command to send a test email and get more debug information:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>./bin/cake passbolt send_test_email <span class="nt">--recipient</span><span class="o">=</span>youremail@domain.com
</code></pre></div></div>

<p>If this fails you should double check what is the recommended configuration in your email provider documentation.
You can also ask on the community forum in case another user have a working configuration for the same provider.</p>

<h3 id="reason-2-email-notifications-are-disabled-in-the-config">Reason 2: Email notifications are disabled in the config</h3>

<p>Another reason could be because email notifications are disabled in you configuration.
You can review such settings in the administration panel, when you are logged in as an administrator in passbolt.</p>

<figure>
    <img src="https://help.passbolt.com/assets/img/help/2019/05/AD_email_notification_send_settings.png" alt="Email Notification Settings - Email Delivery" style="max-width:;" />
    <span class="legend">fig. Email Notification Settings - Email Delivery</span>
</figure>

<p>Depending on the configuration method you have used to setup, you may need to check for configuration 
in <code class="language-plaintext highlighter-rouge">config/passbolt.php</code> or with environment variables you are loading (if you use docker containers for example).</p>

<h3 id="reason-3-the-cron-job-to-send-email-is-missing">Reason 3: The cron job to send email is missing</h3>

<p>Passbolt uses a system of email queue to send email notifications.
In practice this means there is a dedicated job that runs to go through the queue and send
emails at the interval of your choice.</p>

<p>So if you manage to send the test email but are not receiving notifications (such as registration emails),
one of the reason may be that the cron job required to send the emails is missing. 
Depending on the method you used to install, it may have not be set, or failed to set.</p>

<p>In order to find out you should check if you have the following cron for the web server user 
(<code class="language-plaintext highlighter-rouge">www-data</code> on Debian/Ubuntu, <code class="language-plaintext highlighter-rouge">nginx</code> on Centos), running where you passbolt was installed 
(<code class="language-plaintext highlighter-rouge">/var/www/passbolt</code> by default).</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>crontab <span class="nt">-u</span> www-data <span class="nt">-e</span>
<span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> /var/www/passbolt/bin/cake EmailQueue.sender <span class="o">&gt;&gt;</span> /var/log/passbolt.log
</code></pre></div></div>

<p>If the cron is present, you should check if there are more data in the <code class="language-plaintext highlighter-rouge">/var/log/passbolt.log</code> log file, 
it may give you more information about the issue.</p>

<h3 id="reason-4-the-webserver-user-is-not-allowed-to-run-cron-jobs">Reason 4: The webserver user is not allowed to run cron jobs</h3>

<p>On some system, like RHEL or Centos, the<code class="language-plaintext highlighter-rouge">nginx</code> user may not have the right to run the cron job to send emails,
because of your PAM configuration. In this case you may want to add <code class="language-plaintext highlighter-rouge">nginx</code> to the PAM config to have <code class="language-plaintext highlighter-rouge">cron</code> 
and <code class="language-plaintext highlighter-rouge">crond:local</code> permissions.</p>

<h3 id="reason-5-there-is-an-issue-with-the-database-schema-related-to-the-email-queue">Reason 5: There is an issue with the database schema related to the email queue</h3>

<p>If after an update you are getting error messages such as:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Exception: SQLSTATE[42S22]: Column not found: 1054 Unknown column ‚ÄòEmailQueue.to‚Äô in ‚Äòfield list‚Äô ...
</code></pre></div></div>

<p>It is possible that the wrong version of the data model is stored in the cache. This can happen
if the cache is not cleared after an install or an update. You can try clearing out the cache to solve this.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./bin/cake cache clear_all
</code></pre></div></div>

                        </div>

                    <div class="col4 last push1" markdown="1">
                        
                            <div class="message tldr notice">
    <p>Not finding what you are looking for? You can also ask the community on the forum.</p>
    
    <a href="https://community.passbolt.com" class="button ">Talk to a human</a>
    
</div>

                        
                    </div>
                    </div>

                    
                    <div class="row" markdown="1">
                        <div class="col7" markdown="1">
                            <h3>Other frequently asked questions in the same category</h3>
                            <ul>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <li>
        <a href="/faq/hosting/how-to-install">How to install passbolt server</a>
    </li>
    
    
    
    
    
    <li>
        <a href="/faq/hosting/how-to-backup">How to make passbolt backups</a>
    </li>
    
    
    
    
    
    <li>
        <a href="/faq/hosting/how-to-update">How can I update my passbolt server?</a>
    </li>
    
    
    
    
    
    <li>
        <a href="/faq/hosting/hosting-requirements">What are the minimum server requirements?</a>
    </li>
    
    
    
    
    
    <li>
        <a href="/faq/hosting/where-to-host">Does passbolt provide hosting?</a>
    </li>
    
    
    
    
    
    <li>
        <a href="/faq/hosting/installation-issue-help">Where can I get help for installation issues?</a>
    </li>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <li>
        <a href="/faq/hosting/why-unsafe">Why do I see an unsafe mode banner in the footer?</a>
    </li>
    
    
    
    
    
    
    
    
    
    <li>
        <a href="/faq/hosting/why-email-not-sent">Why are my emails not being sent?</a>
    </li>
    
    
    
    
    
    
    
    
    
    <li>
        <a href="/faq/hosting/why-haveged-virtual-env">Why should I install haveged on virtual environments?</a>
    </li>
    
    
    
    
    
    
    
    
    
    <li>
        <a href="/faq/hosting/update-evaluation-subscription-key">How to update my subscription key</a>
    </li>
    
    
    
    
    
    <li>
        <a href="/faq/hosting/how-to-increase-auto-logout-time">How to increase auto logout time?</a>
    </li>
    
    
    
    
    
    <li>
        <a href="/faq/configure/why-am-i-getting-ldap-synchronization-issues">Why am I getting ldap synchronization issues?</a>
    </li>
    
    
    
    
    
</ul>

                        </div>

                    <div class="col4 last push1" markdown="1">
                    </div>

                    </div>

                    </div>
                    

                </article>
            </div>
        </div>
    </div>

    <footer>
        <div class="footer">
            <ul class="footer-links">
                <li><a href="https://www.passbolt.com/licence">Terms</a></li>
                <li><a href="https://www.passbolt.com/privacy">Privacy</a></li>
                <li><a href="https://www.passbolt.com/credits">Credits</a></li>
                <li><a href="https://careers.passbolt.com">Careers</a></li>
            </ul>
        </div>
    </footer>
    <div id="cookies-eu-banner" class="visually-hidden">
        üç™ &nbsp; Do you accept cookies for statistical purposes?
        <a href="https://www.passbolt.com/privacy" id="cookies-eu-more">(Read more)</a>
        <a class="button primary" id="cookies-eu-accept">Accept</a>
        <a id="cookies-eu-reject">No thanks!</a>
    </div>


</div>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-23506466-3"></script>
<script src="https://code.jquery.com/jquery-3.5.0.slim.min.js" integrity="sha384-/IFzzQmt1S744I+IQO4Mc1uphkxbXt1tEwjQ/qSw2p8pXWck09sLvqHmKDYYwReJ" crossorigin="anonymous"></script>
<script src="https://help.passbolt.com/assets/js/cookies-eu-banner.js"></script>
<script src="https://help.passbolt.com/assets/js/analytics.js"></script>
<script src="https://help.passbolt.com/assets/js/greedynav.js"></script>
</body>
</html>
