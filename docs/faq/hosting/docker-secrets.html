<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Passbolt Help | Docker Secrets</title>
    <!--
             ____                  __          ____
            / __ \____  _____ ____/ /_  ____  / / /_
           / /_/ / __ `/ ___/ ___/ __ \/ __ \/ / __/
          / ____/ /_/ (__  |__  ) /_/ / /_/ / / /_
         /_/    \__,_/____/____/_.___/\____/_/\__/

         Open source password manager for teams
         © 2019 Passbolt SA

     -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="This page should give you the information necessary to successfully use Docker Secrets with your Passbolt installation.">
    <meta property="og:image" content="https://help.passbolt.com/assets/img/background/og_preview.jpg" />
    <meta property="og:title" content="Docker Secrets" />
    <meta property="og:description" content="This page should give you the information necessary to successfully use Docker Secrets with your Passbolt installation." />
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/help.min.css">
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/highlight.css">
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/cookie-eu-banner.css">
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/custom.css">
    <link rel="canonical" href="https://help.passbolt.com/faq/hosting/docker-secrets">
    <link rel="shortcut icon" type="image/x-icon" href="https://help.passbolt.com/assets/favicon.ico" />
    <link rel="alternate" type="application/rss+xml" title="Passbolt | Help" href="https://help.passbolt.com/feed.xml">
</head>

<body>
<div id="container" class="help page background">
    <header>
        <div class="header first ">
            <nav class="greedy">
                <div class="top navigation primary">
                    <ul class="links clearfix">
                        <li class="home with-text"><a href="http://www.passbolt.com/"><span>home</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/services"><span>pricing</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/roadmap"><span>roadmap</span></a></li>
                        <li class="left"><a href="https://community.passbolt.com/"><span>forum</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/blog"><span>blog</span></a></li>
                        <li class="left selected"><a href="https://help.passbolt.com/"><span>help</span></a></li>
                        <li class="left"><a href="https://demo.passbolt.com" class="highlighted" target="_blank" rel="noopener"><span>try it!</span></a></li>
                    </ul>
                    <button class="hidden" count="0">more</button>
                    <ul class="hidden-links hidden"></ul>
                </div>
            </nav>
        </div>
    </header>
    <div class="header second">
        <div class="col1">
            <div class="logo no-img">
                <h1><span>Passbolt</span></h1>
            </div>
        </div>
        <div class="col2 search-wrapper">
            <h2 class="visuallyhidden">Help Search</h2>
            <div>
                <form class="search ready" action="/search.html" method="get">
                    <div class="input required">
                        <label for="search-box">Search</label>
                        <input id="search-box" name="query" maxlength="64" placeholder="Help search" class="fuzzy-search" type="search">
                    </div>
                    <button value="search">
                        <i class="fa fa-fw fa-search"></i>
                        <span class="text visuallyhidden">search</span>
                    </button>
                </form>
            </div>
        </div>
        <div class="col3">
            <div class="edit-on-github">
                <a href="https://github.com/passbolt/passbolt_help/edit/master/_faq/hosting/001-docker-secrets.md" class="button">
                    <i class="fa fa-github-alt fa-fw"></i> Edit on github</a>
            </div>
        </div>
    </div>


    <div class="panel main" aria-label="Content">
        <div class="panel left">
            <div class="navigation-help" role="navigation">
    <ul>
        <li><h2>All FAQs</h2></li>
        

        
        <li>
        
            <a href="https://help.passbolt.com/faq/discover">Discover</a>
        </li>
        

        
        <li>
        
            <a href="https://help.passbolt.com/faq/start">Get started</a>
        </li>
        

        
        <li class="selected">
        
            <a href="https://help.passbolt.com/faq/hosting">Hosting</a>
        </li>
        

        
        <li>
        
            <a href="https://help.passbolt.com/faq/contribute">Contribute</a>
        </li>
        

        
        <li>
        
            <a href="https://help.passbolt.com/faq/security">Security</a>
        </li>
        

        
        <li>
        
            <a href="https://help.passbolt.com/faq/legal">Legal</a>
        </li>
        
    </ul>
</div>

        </div>
        <div class="panel middle" data-spy="scroll" data-target=".scrollspy">
            <div class="grid grid-responsive-12">
                <article>
                    <div class="row" id="introduction">
    <div class="col12">
        <div class="breadcrumbs">
            <ul>
                <li>
                    <div class="main-cell">
                        <a href="https://www.passbolt.com"><span>home</span></a>
                    </div>
                </li>
                <li>
                    <div class="main-cell">
                        <a href="https://help.passbolt.com"><span>help</span></a>
                    </div>
                </li>
                <li>
                    <div class="main-cell">
                        <a href="https://help.passbolt.com/faq"><span>FAQ</span></a>
                    </div>
                </li>
                <li>
                    <div class="main-cell">
                        <a href=""><span>Docker Secrets</span></a>
                    </div>
                </li>
            </ul>
        </div>
    </div>
</div>


                    <div class="row" markdown="1">
                        <div class="col7" markdown="1">
                         <h1>Docker Secrets</h1>
                            <p>This page should give you the information necessary to successfully use <a href="https://docs.docker.com/engine/swarm/secrets/">Docker Secrets</a> with your Passbolt installation.</p>

<div class="message notice">
    <p>
    <b>Notice:</b> For more information you can learn about secrets for <a href="https://docs.docker.com/compose/compose-file/#secrets">Compose</a> and <a href="https://docs.docker.com/engine/swarm/secrets/">Swarm</a>
    </p>
    
</div>

<h3 id="supported-environment-variables">Supported environment variables</h3>
<p>List of <a href="/configure/environment/reference.html" target="_blank">environment variables</a> that can be received as Docker secret and the matching Docker secret path environment variable:</p>

<table class="table-parameters">
  <thead>
    <tr>
      <th>PASSBOLT ENV VAR</th>
      <th>DOCKER SECRET ENV VAR</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>DATASOURCES_DEFAULT_PASSWORD</td>
      <td>DATASOURCES_DEFAULT_PASSWORD_FILE</td>
    </tr>
    <tr>
      <td>DATASOURCES_DEFAULT_HOST</td>
      <td>DATASOURCES_DEFAULT_HOST_FILE</td>
    </tr>
    <tr>
      <td>DATASOURCES_DEFAULT_USERNAME</td>
      <td>DATASOURCES_DEFAULT_USERNAME_FILE</td>
    </tr>
    <tr>
      <td>DATASOURCES_DEFAULT_DATABASE</td>
      <td>DATASOURCES_DEFAULT_DATABASE_FILE</td>
    </tr>
  </tbody>
</table>

<h3 id="supported-secret-files">Supported secret files</h3>
<p>List of file that contains secret data and the matching Docker secret path environment variable:</p>

<table class="table-parameters">
  <thead>
    <tr>
      <th>FILE PATH</th>
      <th>DOCKER SECRET ENV VAR</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>etc/passbolt/gpg/serverkey.asc</td>
      <td>PASSBOLT_GPG_SERVER_KEY_PUBLIC_FILE</td>
    </tr>
    <tr>
      <td>/etc/passbolt/gpg/serverkey_private.asc</td>
      <td>PASSBOLT_GPG_SERVER_KEY_PRIVATE_FILE</td>
    </tr>
    <tr>
      <td>/etc/ssl/certs/certificate.crt</td>
      <td>PASSBOLT_SSL_SERVER_CERT_FILE</td>
    </tr>
    <tr>
      <td>/etc/ssl/certs/certificate.key</td>
      <td>PASSBOLT_SSL_SERVER_KEY_FILE</td>
    </tr>
  </tbody>
</table>

<h3 id="examples">Examples</h3>
<h4 id="inject-datasources_default_password-variable-usign-docker-secrets">Inject DATASOURCES_DEFAULT_PASSWORD variable usign Docker secrets</h4>
<p>Following the Docker secrets documentation for Docker compose we have the following docker-compose.yaml example:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>services:

   passbolt:
     ... 
     environment:
       DATASOURCES_DEFAULT_PASSWORD_FILE: /run/secrets/db_password
     secrets:
       - db_password
     ...

secrets:
   db_password:
     file: db_password.txt
</code></pre></div></div>

<p>In this example we want to inject the contents of ‘db_password.txt’ in the DATASOURCES_DEFAULT_PASSWORD environment variable inside the Passbolt container.</p>

<p>To do so we create the secret and call it db_password in this snippet:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>secrets:
   db_password:
     file: db_password.txt
</code></pre></div></div>

<p>Once we have this, we use this secret on the Passbolt service:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>services:
   passbolt:
     ... 
     secrets:
       - db_password
     ...
</code></pre></div></div>

<p>Finally, we have to check which environment variable we have to set in order to get the contents of the secret file in the DATASOURCES_DEFAULT_PASSWORD var. So we check in the Supported environment variables section to get the correct variable (DATASOURCES_DEFAULT_PASSWORD_FILE in this case) and set it on the Passbolt container environment with the path that points to the secret name:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>services:
   passbolt:
     ... 
     environment:
       DATASOURCES_DEFAULT_PASSWORD_FILE: /run/secrets/db_password
</code></pre></div></div>

<h4 id="inject-etcsslcertscertificatepem-file-using-docker-secrets">Inject /etc/ssl/certs/certificate.pem file using Docker secrets</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>services:

   passbolt:
     ... 
     environment:
       PASSBOLT_SSL_SERVER_CERT_FILE: /run/secrets/ssl_cert
     secrets:
       - ssl_cert
     ...

secrets:
   ssl_cert:
     file: ssl_cert.pem
</code></pre></div></div>

<p>In this example we want to inject the contents of ‘ssl_cert.pem’ in the ‘/etc/ssl/certs/certificate.pem’ file inside the Passbolt container.</p>

<p>To do so, we create a Docker secret and call it ssl_cert with the contents of ssl_cert.pem:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>secrets:
   ssl_cert:
     file: ssl_cert.pem
</code></pre></div></div>

<p>Then we inject the secret in the Passbolt service:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>services:
   passbolt:
     ... 
     secrets:
       - ssl_cert
     ...
</code></pre></div></div>
<p>And finally, we go to the supported secret files section to get which environment variable is the one that points to the path I want to fill ( PASSBOLT_SSL_SERVER_CERT_FILE which points to ‘/etc/ssl/certs/certificate.crt’):</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>services:
   passbolt:
     ... 
     environment:
       PASSBOLT_SSL_SERVER_CERT_FILE: /run/secrets/ssl_cert
</code></pre></div></div>
<h4 id="create-secret-outside-of-compose-file">Create secret outside of compose file</h4>
<p>You can also create secrets directly so that you don’t have to retain the file with the secret. This example will show you how to do that.</p>

<p>The first step here is to create the secret:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker secret create gpg-public public.key
</code></pre></div></div>

<p>You will then need to modify your compose file to designate this as an external secret:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>secrets:
   gpg-public:
     external: true
</code></pre></div></div>

<p>Finally you will need to make sure this secret is used by the Passbolt service:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>services:

   passbolt:
     ... 
     environment:
       PASSBOLT_GPG_SERVER_KEY_PUBLIC_FILE: /run/secrets/gpg-public
     secrets:
       - gpg-public
     ...
</code></pre></div></div>

                        </div>

                    <div class="col4 last push1" markdown="1">
                        
                            <div class="message tldr notice">
    <p>Not finding what you are looking for? You can also ask the community on the forum.</p>
    
    <a href="https://community.passbolt.com" class="button ">Talk to a human</a>
    
</div>

                        
                    </div>
                    </div>

                    
                    <div class="row" markdown="1">
                        <div class="col7" markdown="1">
                            <h3>Other frequently asked questions in the same category</h3>
                            <ul>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <li>
        <a href="/faq/hosting/how-to-rotate-server-gpg-keys">How to rotate server GPG keys</a>
    </li>
    
    
    
    
    
    
    
    
    
    <li>
        <a href="/faq/hosting/mobile-faq">iOS / Android Mobile FAQ</a>
    </li>
    
    
    
    
    
    <li>
        <a href="/faq/hosting/set-up-ntp">How to set up NTP</a>
    </li>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <li>
        <a href="/faq/hosting/how-to-install">How to install passbolt server</a>
    </li>
    
    
    
    
    
    <li>
        <a href="/faq/hosting/how-to-backup">How to make passbolt backups</a>
    </li>
    
    
    
    
    
    <li>
        <a href="/faq/hosting/how-to-update">How can I update my passbolt server?</a>
    </li>
    
    
    
    
    
    <li>
        <a href="/faq/hosting/hosting-requirements">What are the minimum server requirements?</a>
    </li>
    
    
    
    
    
    <li>
        <a href="/faq/hosting/where-to-host">Does passbolt provide hosting?</a>
    </li>
    
    
    
    
    
    <li>
        <a href="/faq/hosting/installation-issue-help">Where can I get help for installation issues?</a>
    </li>
    
    
    
    
    
    <li>
        <a href="/faq/hosting/why-unsafe">Why do I see an unsafe mode banner in the footer?</a>
    </li>
    
    
    
    
    
    <li>
        <a href="/faq/hosting/why-email-not-sent">Why are my emails not being sent?</a>
    </li>
    
    
    
    
    
    <li>
        <a href="/faq/hosting/why-haveged-virtual-env">Why should I install haveged on virtual environments?</a>
    </li>
    
    
    
    
    
    <li>
        <a href="/faq/hosting/update-evaluation-subscription-key">How to update my subscription key</a>
    </li>
    
    
    
    
    
    <li>
        <a href="/faq/configure/why-am-i-getting-ldap-synchronization-issues">Why am I getting ldap synchronization issues?</a>
    </li>
    
    
    
    
    
    <li>
        <a href="/faq/hosting/how-to-increase-auto-logout-time">How to increase auto logout time?</a>
    </li>
    
    
    
    
    
    <li>
        <a href="/faq/hosting/firewall-rules">Firewall rules</a>
    </li>
    
    
    
    
    
    <li>
        <a href="/faq/hosting/how-to-generate-jwt-key-pair-manually">How to generate JWT key pair manually</a>
    </li>
    
    
    
    
    
    <li>
        <a href="/faq/hosting/troubleshoot-docker">Troubleshoot Docker</a>
    </li>
    
    
    
    
    
    <li>
        <a href="/faq/hosting/how-to-migrate-from-http-to-https">How to migrate from HTTP to HTTPS</a>
    </li>
    
    
    
    
    
    <li>
        <a href="/faq/hosting/how-to-use-rootless-images">How to use docker rootless images</a>
    </li>
    
    
    
    
    
    <li>
        <a href="/faq/hosting/how-to-import-ssl-certificate-on-mobile">How to import SSL certificate on mobile application</a>
    </li>
    
    
    
    
    
    <li>
        <a href="/faq/hosting/troubleshoot-ssl">Troubleshoot SSL</a>
    </li>
    
    
    
    
    
    <li>
        <a href="/faq/hosting/how-to-install-passbolt-non-interactive">How to install passbolt in non-interactive mode?</a>
    </li>
    
    
    
    
    
    <li>
        <a href="/faq/hosting/troubleshoot-helm">Troubleshoot Helm</a>
    </li>
    
    
    
    
    
    <li>
        <a href="/faq/hosting/docker-secrets">Docker Secrets</a>
    </li>
    
    
    
    
    
    <li>
        <a href="/faq/hosting/logs">How can I check logs on my server?</a>
    </li>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
</ul>

                        </div>

                    <div class="col4 last push1" markdown="1">
                    </div>

                    </div>

                    </div>
                    

                </article>
            </div>
        </div>
    </div>

    <footer>
        <div class="footer">
            <ul class="footer-links">
                <li><a href="https://www.passbolt.com/licence">Terms</a></li>
                <li><a href="https://www.passbolt.com/privacy">Privacy</a></li>
                <li><a href="https://www.passbolt.com/credits">Credits</a></li>
                <li><a href="https://careers.passbolt.com">Careers</a></li>
            </ul>
        </div>
    </footer>
    <div id="cookies-eu-banner" class="visually-hidden">
        🍪 &nbsp; Do you accept cookies for statistical purposes?
        <a href="https://www.passbolt.com/privacy" id="cookies-eu-more">(Read more)</a>
        <a class="button primary" id="cookies-eu-accept">Accept</a>
        <a id="cookies-eu-reject">No thanks!</a>
    </div>


</div>
<script src="https://consent.cookiebot.com/uc.js" data-cbid="900808a8-f178-4994-b2ad-66bf3ccca5f7" data-blockingmode="auto" strategy="beforeInteractive"></script>
<script src="https://help.passbolt.com/assets/js/matomo-tag-manager.js"></script>
<script src="https://help.passbolt.com/assets/js/matomo-analytics.js"></script>
<script src="https://code.jquery.com/jquery-3.5.0.slim.min.js" integrity="sha384-/IFzzQmt1S744I+IQO4Mc1uphkxbXt1tEwjQ/qSw2p8pXWck09sLvqHmKDYYwReJ" crossorigin="anonymous"></script>
<script src="https://help.passbolt.com/assets/js/analytics.js"></script>
<script src="https://help.passbolt.com/assets/js/greedynav.js"></script>
</body>
</html>
