<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Update passbolt server component</title>
    <!--
             ____                  __          ____
            / __ \____  _____ ____/ /_  ____  / / /_
           / /_/ / __ `/ ___/ ___/ __ \/ __ \/ / __/
          / ____/ /_/ (__  |__  ) /_/ / /_/ / / /_
         /_/    \__,_/____/____/_.___/\____/_/\__/

         Open source password manager for teams
         © 2018 Passbolt SARL

     -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta property="og:image" content="https://help.passbolt.com/assets/img/background/og_preview.jpg" />
    <meta property="og:title" content="Update passbolt server component" />
    <meta property="og:description" content="" />

    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/help.min.css">
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/highlight.css">
    <link rel="canonical" href="https://help.passbolt.com/hosting/update">
    <link rel="shortcut icon" type="image/x-icon" href="https://help.passbolt.com/assets/favicon.ico" />
    <link rel="alternate" type="application/rss+xml" title="Passbolt | Help" href="https://help.passbolt.com/feed.xml">

</head>
<body>
<div id="container" class="help page background">
    <header>
        <div class="header first ">
            <nav class="greedy">
                <div class="top navigation primary">
                    <ul class="links clearfix">
                        <li class="home with-text"><a href="http://www.passbolt.com/"><span>home</span></a></li>
                        <li class="left"><a href="https://demo.passbolt.com" target="_blank" rel="noopener"><span>demo</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/services"><span>pricing</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/roadmap"><span>roadmap</span></a></li>
                        <li class="left"><a href="https://community.passbolt.com"><span>forum</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/blog"><span>blog</span></a></li>
                        <li class="left selected"><a href="//help.passbolt.com/"><span>help</span></a></li>
                    </ul>
                    <button class="hidden" count="0">more</button>
                    <ul class="hidden-links hidden"></ul>
                </div>
            </nav>
        </div>
    </header>
    <div class="header second">
        <div class="col1">
            <div class="logo no-img">
                <h1><span>Passbolt</span></h1>
            </div>
        </div>
        <div class="col2_3 search-wrapper">
            <h2 class="visuallyhidden">Help Search</h2>
            <div>
                <form class="search ready" action="/search.html" method="get">
                    <div class="input required">
                        <label for="search-box">Search</label>
                        <input id="search-box" name="query" maxlength="64" placeholder="Help search" class="fuzzy-search" type="search">
                    </div>
                    <button value="search">
                        <i class="fa fa-fw fa-search"></i>
                        <span class="text visuallyhidden">search</span>
                    </button>
                </form>
            </div>
        </div>
    </div>
    <div class="panel main" aria-label="Content">
        <div class="panel left">
            



<div class="navigation wizard" role="navigation">
    <ul>
        <li><h2>Hosting</h2></li>
        

        
        
        <li>
        
            <a href="https://help.passbolt.com/hosting/install">Installation</a>
        </li>
        
        

        
        
        <li class="selected">
        
            <a href="https://help.passbolt.com/hosting/update">Update</a>
        </li>
        
        

        
        
        <li>
        
            <a href="https://help.passbolt.com/hosting/backup">Backup</a>
        </li>
        
        

        
        

        
        

        
        
    </ul>
</div>





        </div>
        <div class="panel middle" data-spy="scroll" data-target=".scrollspy">
            <div class="grid grid-responsive-12">
                <article>
                    <div class="row" id="introduction">
    <div class="col12">
        <div class="breadcrumbs">
            <ul>
                <li>
                    <div class="main-cell">
                        <a href="https://www.passbolt.com"><span>home</span></a>
                    </div>
                </li>
                <li>
                    <div class="main-cell">
                        <a href="/"><span>help</span></a>
                    </div>
                </li>
                
                <li>
                    <div class="main-cell">
                        <a href="/hosting"><span>hosting</span></a>
                    </div>
                </li>
                
                
                <li>
                    <div class="main-cell">
                        <a href="https://help.passbolt.com/hosting/update.html"><span>update</span></a>
                    </div>
                </li>
                
            </ul>
        </div>
    </div>
</div>

                    <div class="row" markdown="1">
<div class="col7" markdown="1">
<h1>Update passbolt server component</h1>
</div>
</div>

                    <div class="row">
  <div class="col7">

    <h2 id="which-update-process-to-follow">Which update process to follow?</h2>

    <p>Each passbolt release follows the concept of <a href="http://www.semver.org">Semantic Versioning</a>. Given a version number MAJOR.MINOR.PATCH, we increment as follow:</p>

    <ul>
      <li><strong>PATCH</strong> version when we make backwards-compatible bug fixes. So let’s say you are running passbolt v1.3.2 and the latest one available is v1.3.7 you will need to perform a patch update.</li>
      <li><strong>MINOR</strong> version when we add functionality in a backwards-compatible manner. Similarly say you have passbolt v1.2.0 installed and the latest version available is v1.3.2, you will need to perform a minor version update.</li>
      <li><strong>MAJOR</strong> version when incompatible API changes are made. You get the deal for major version update: that would mean going from v1.3.7 to v2.0.0 for example.</li>
    </ul>

    <h2 id="where-to-find-the-latest-release-version-number">Where to find the latest release version number?</h2>

    <p>You can find information about which version is the latest in the <a href="?php echo Router::url('/release/notes',true); ?">release notes</a>. It is generally a good idea to check these notes before running an update. You can also find it on the official <a href="https://github.com/passbolt/passbolt_api/blob/master/app/Config/version.php">GIT repository</a>.</p>

    <h2 id="where-to-find-the-version-number-for-a-given-installation">Where to find the version number for a given installation?</h2>

    <p>You can check <code class="highlighter-rouge">app/Config/version.php</code> to know the version number for your local instance. You can also hover on the <em><span class="visuallyhidden">heart</span></em> icon at the bottom right corner of any passbolt screen. The first item is the server version, the second the one from the browser extension.</p>

    <figure>
    <img src="/assets/img/help/2017/12/AN_footer_version_help.png" alt="footer version helper" style="max-width:210px;" />
    <span class="legend">fig. footer version helper</span>
</figure>

    <h2 id="patch-update">Patch update</h2>

    <p>Performing a patch update is the easiest. All you need to do is checkout the latest version.</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>git pull origin master
</code></pre></div>    </div>

    <p>You can also checkout a specific version and use branches to switch versions. For example for version 1.0.9:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>git fetch <span class="nt">--tags</span>
<span class="nv">$ </span>git checkout tags/v1.0.9 <span class="nt">-b</span> tags/v1.0.9
</code></pre></div>    </div>

    <p>Optionally, you can login as an administrator and check the status on the healthcheck page</p>

    <figure>
    <img src="/assets/img/screenshots/AD_healthcheck.jpg" alt="Example of healthcheck screen" style="max-width:;" />
    <span class="legend">fig. Example of healthcheck screen</span>
</figure>

    <h2 id="minor-update">Minor update</h2>

    <p>Every now and again some releases will introduce some database and/or configuration files changes. Here is a step by step guide on how to perform a minor update.</p>

    <h4 id="take-your-site-down">1. Take your site down</h4>
    <p>Create a temporary webserver configuration to redirect all the requests to a maintenance page. You can find resources how to do this online: <a href="http://stackoverflow.com/questions/21709026/apache-enable-maintenance-mode-across-all-virtual-hosts">here is an example for apache</a> .</p>

    <h4 id="get-the-latest-release">2. Get the latest release</h4>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>git fetch
<span class="nv">$ </span>git checkout tags/v1.x.x
</code></pre></div>    </div>

    <h4 id="review-the-configuration-files">3. Review the configuration files</h4>

    <p>While we try to provide backward compatibility by providing safe fallbacks for new configuration files items, it is recommended that you review your configuration files when the default changes.</p>

    <p>For example let’s take the scenario where you are running v1.1.0 and you want to upgrade to v1.3.2. We can check that both the app and core files have changed as follow:</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>git diff <span class="nt">--name-status</span> v1.3.2 v1.1.0 | <span class="nb">grep</span> <span class="s1">'php.default'</span>
M	app/Config/app.php.default
M	app/Config/core.php.default
</code></pre></div>    </div>

    <h4 id="make-a-backup-of-your-database">4. Make a backup of your database</h4>

    <p>Prior to running a database migration script it is very important that you perform a backup, in case something goes wrong. You can do this using mysqldump, with for example:</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>mysqldump <span class="nt">-u</span><span class="o">[</span>user] <span class="nt">-p</span><span class="o">[</span>pass] db <span class="o">&gt;</span> /path/to/backup.sql
</code></pre></div>    </div>

    <h4 id="run-the-migration-script">5. Run the migration script</h4>

    <p>To see if a database schema migration script is available you can run the following command:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>./app/Console/cake Migrations.migration status
Cake Migration Shell
<span class="nt">---------------------------------------------------------------</span>
Application

Current version:
  <span class="c">#1465367816 1465367816_Migration_1.1.0</span>
Latest version:
  <span class="c">#1479926461 1479926461_Migration_1.3.0</span>
<span class="nt">---------------------------------------------------------------</span>
</code></pre></div>    </div>

    <p>In this case we can see that a migration is needed, so we run the following:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>./app/Console/cake Migrations.migration run all
Cake Migration Shell
<span class="nt">---------------------------------------------------------------</span>
Running migrations:
  <span class="o">[</span>1474629203] 1474629203_Migration_1.2.0 <span class="o">(</span>2016-09-23 16:43:23<span class="o">)</span>
      <span class="o">&gt;</span> Changing field <span class="s2">"uri"</span> from table <span class="s2">"resources"</span><span class="nb">.</span>

  <span class="o">[</span>1479926461] 1479926461_Migration_1.3.0 <span class="o">(</span>2016-11-24 00:11:01<span class="o">)</span>

Allow sending anonymous usage statistics? <span class="o">(</span>y/n<span class="o">)</span>
<span class="o">[</span>n] <span class="o">&gt;</span> y
<span class="nt">---------------------------------------------------------------</span>
All migrations have completed.
</code></pre></div>    </div>

    <p>As you can see above, the migration script for v1.2.0 will also be applied automatically. Sometimes also, for example with the introduction of the anonymous usage statistics, the migration script can prompt you for input.</p>

    <h4 id="put-your-site-back-online">6. Put your site back online!</h4>

    <p>As an administrator (or as any user in debug mode) you can go and check on the /healthcheck page to see if your instance configuration is looking good.</p>

    <p><strong>(Optional) If you run into some issues:</strong></p>

    <ul>
      <li>Make a copy of the errors messages</li>
      <li>Checkout the previous working version using git</li>
      <li>Drop the database and load your backup data to restore to a previously working version.</li>
      <li>Send us an <a href="mailto:contact@passbolt.com">email</a> with the details of the error or fill in a bug report using github, using as much details as possible such as your OS, php, mysql environment versions.</li>
    </ul>

    <h2 id="major-update">Major update</h2>

    <p>There is nothing special to say about major updates yet since we have not done any yet! We will most likely provide an update manual for each major versions and list them here.</p>

    <h2 id="last-updated">Last updated</h2>

    <p>This article was last updated on 
January
20th,
2017.</p>

  </div>
  <div class="col4 last push1">

    <div class="message tldr notice">
    <p>Are you experiencing issues when updating passbolt?</p>
    
    <a href="https://community.passbolt.com/c/installation-issues" class="button primary">Ask the community!</a>
    
</div>

    <div class="message ">
    <p></p>
    
</div>

  </div>
</div>

                </article>
            </div>
        </div>
    </div>
    <footer>
        <div class="footer">
            <ul class="footer-links">
                <li><a href="https://www.passbolt.com/licence">Terms</a></li>
                <li><a href="https://www.passbolt.com/privacy">Privacy</a></li>
                <li><a href="https://www.passbolt.com/credits">Credits</a></li>
            </ul>
        </div>
    </footer>
</div>
<!-- Piwik -->
<script type="text/javascript">
  var _paq = _paq || [];
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//passbolt.piwikpro.com/";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', 1]);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<noscript><p><img src="//passbolt.piwikpro.com//piwik.php?idsite=1" style="border:0;" alt="" /></p></noscript>
<!-- End Piwik Code -->
</body>
</html>
