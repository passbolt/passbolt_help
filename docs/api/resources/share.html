<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Passbolt Help | Share</title>
    <!--
             ____                  __          ____
            / __ \____  _____ ____/ /_  ____  / / /_
           / /_/ / __ `/ ___/ ___/ __ \/ __ \/ / __/
          / ____/ /_/ (__  |__  ) /_/ / /_/ / / /_
         /_/    \__,_/____/____/_.___/\____/_/\__/

         Open source password manager for teams
         ¬© 2019 Passbolt SA

     -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="The help site for passbolt, the open source password manager for teams. This site contains frequently asked questions, article to troubleshoot common issues,...">
    <meta property="og:image" content="https://help.passbolt.com/assets/img/background/og_preview.jpg" />
    <meta property="og:title" content="Share" />
    <meta property="og:description" content="The help site for passbolt, the open source password manager for teams. This site contains frequently asked questions, article to troubleshoot common issues,..." />
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/help.min.css">
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/highlight.css">
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/cookie-eu-banner.css">
    <link rel="canonical" href="https://help.passbolt.com/api/resources/share">
    <link rel="shortcut icon" type="image/x-icon" href="https://help.passbolt.com/assets/favicon.ico" />
    <link rel="alternate" type="application/rss+xml" title="Passbolt | Help" href="https://help.passbolt.com/feed.xml">

</head>

<body>
<div id="container" class="help page background">
        <header>
        <div class="header first ">
            <nav class="greedy">
                <div class="top navigation primary">
                    <ul class="links clearfix">
                        <li class="home with-text"><a href="http://www.passbolt.com/"><span>home</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/services"><span>pricing</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/roadmap"><span>roadmap</span></a></li>
                        <li class="left"><a href="https://community.passbolt.com/"><span>forum</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/blog"><span>blog</span></a></li>
                        <li class="left selected"><a href="https://help.passbolt.com/"><span>help</span></a></li>
                        <li class="left"><a href="https://demo.passbolt.com" class="highlighted" target="_blank" rel="noopener"><span>try it!</span></a></li>
                    </ul>
                    <button class="hidden" count="0">more</button>
                    <ul class="hidden-links hidden"></ul>
                </div>
            </nav>
        </div>
    </header>
    <div class="header second">
        <div class="col1">
            <div class="logo no-img">
                <h1><span>Passbolt</span></h1>
            </div>
        </div>
        <div class="col2 search-wrapper">
            <h2 class="visuallyhidden">Help Search</h2>
            <div>
                <form class="search ready" action="/search.html" method="get">
                    <div class="input required">
                        <label for="search-box">Search</label>
                        <input id="search-box" name="query" maxlength="64" placeholder="Help search" class="fuzzy-search" type="search">
                    </div>
                    <button value="search">
                        <i class="fa fa-fw fa-search"></i>
                        <span class="text visuallyhidden">search</span>
                    </button>
                </form>
            </div>
        </div>
        <div class="col3">
            <div class="edit-on-github">
                <a href="https://github.com/passbolt/passbolt_help/edit/master/_pages/api/resources/resources-share.md" class="button">
                    <i class="fa fa-github-alt fa-fw"></i> Edit on github</a>
            </div>
        </div>
    </div>


    <div class="panel main" aria-label="Content">
        <div class="panel left">
            <div class="navigation-help scrollspy" role="navigation">
  <ul>
      <li><h2>API Documentation</h2></li>
      

      
      <li>
      
          <a href="https://help.passbolt.com/api">Introduction</a>

          

      </li>
      

      
      <li>
      
          <a href="https://help.passbolt.com/api/authentication">Authentication</a>

          

      </li>
      

      
      <li>
      
          <a href="https://help.passbolt.com/api/resources">Resources</a>

          
          
          <ul>
              
              
              <li>
              
                  <a id='resources-read-index' href="https://help.passbolt.com/api/resources/read-index">Index</a>
              </li>
              
              
              <li>
              
                  <a id='resources-read' href="https://help.passbolt.com/api/resources/read">Read</a>
              </li>
              
              
              <li>
              
                  <a id='resources-create' href="https://help.passbolt.com/api/resources/create">Create</a>
              </li>
              
              
              <li>
              
                  <a id='resources-update' href="https://help.passbolt.com/api/resources/update">Update</a>
              </li>
              
              
              <li>
              
                  <a id='resources-delete' href="https://help.passbolt.com/api/resources/delete">Delete</a>
              </li>
              
              
              <li class="selected">
              
                  <a id='resources-share' href="https://help.passbolt.com/api/resources/share">Share</a>
              </li>
              
          </ul>
          
          

      </li>
      

      
      <li>
      
          <a href="https://help.passbolt.com/api/secrets">Secrets</a>

          

      </li>
      

      
      <li>
      
          <a href="https://help.passbolt.com/api/permissions">Permissions</a>

          

      </li>
      

      
      <li>
      
          <a href="https://help.passbolt.com/api/users">Users</a>

          

      </li>
      

      
      <li>
      
          <a href="https://help.passbolt.com/api/groups">Groups</a>

          

      </li>
      

      
      <li>
      
          <a href="https://help.passbolt.com/api/gpgkeys">OpenPGP Keys</a>

          

      </li>
      

      
      <li>
      
          <a href="https://help.passbolt.com/api/comments">Comments</a>

          

      </li>
      

      
      <li>
      
          <a href="https://help.passbolt.com/api/favorites">Favorites</a>

          

      </li>
      
  </ul>
</div>

        </div>
        <div class="panel middle" data-spy="scroll" data-target=".scrollspy">
            <div class="grid grid-responsive-12">
                <article>
                    <div class="row" id="introduction">
    <div class="col12">
        <div class="breadcrumbs">
            <ul>
                <li>
                    <div class="main-cell">
                        <a href="https://www.passbolt.com"><span>home</span></a>
                    </div>
                </li>
                <li>
                    <div class="main-cell">
                        <a href="https://help.passbolt.com"><span>help</span></a>
                    </div>
                </li>
                <li>
                    <div class="main-cell">
                        <a href="/api"><span>api</span></a>
                    </div>
                </li>
                
                
                <li>
                    <div class="main-cell">
                        <a href="/api/resources"><span>resources</span></a>
                    </div>
                </li>
                
                
                <li>
                    <div class="main-cell">
                        <a href="https://help.passbolt.com/api/resources/share"><span>share</span></a>
                    </div>
                </li>
                
            </ul>
        </div>
    </div>
</div>


                    <div class="row" markdown="1">
                    <div class="col8" markdown="1">
                    <h1>Share</h1>
                    <p>A <a href="/api/resources">Resource</a> can be shared with another <a href="/api/users">User</a> or <a href="/api/groups">Group</a>. Which essentially means adding permissions to the Resource for the User/Group.</p>

<p>Permissions in passbolt use some Access Control List (ACL) lingo. Mostly two concepts:</p>
<ul>
  <li>Access Control Object (ACO) that represents something that is wanted, like a resource and its secrets.</li>
  <li>Access Request Object (ARO) represents something that wants an ACO, so a user or a group.</li>
</ul>

<h3 id="get-all-aros">Get all AROs</h3>

<p>In order to know the list of AROs with whom a Resource can be shared, you can use the <code class="language-plaintext highlighter-rouge">search-aros</code> endpoint.</p>

<p>To get the ARO list make a GET request to /share/search-aros.json</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GET /share/search-aros.json?api-version=v2
</code></pre></div></div>

<p>The response returned will have an array of json objects, each representing either a Group or a User.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"header"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1e0b7ca1-8427-4ec4-a46e-b3dc4f11f878"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"success"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"servertime"</span><span class="p">:</span><span class="w"> </span><span class="mi">1554968444</span><span class="p">,</span><span class="w">
        </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"app_share_searchArosToShareWith_success"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10807e9e-d525-5acc-b05d-cccbbd252a93"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The operation was successful."</span><span class="p">,</span><span class="w">
        </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"</span><span class="se">\/</span><span class="s2">share</span><span class="se">\/</span><span class="s2">search-aros.json?api-version=v2"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"code"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"body"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"user_count"</span><span class="p">:</span><span class="w"> </span><span class="s2">"18"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bda0a05c-b1fa-58be-b5b9-446e65ace052"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Group Name"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"deleted"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="nl">"created"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-01-08T13:39:25+00:00"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"modified"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-01-08T13:39:25+00:00"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"created_by"</span><span class="p">:</span><span class="w"> </span><span class="s2">"d57c10f5-639d-5160-9c81-8a0c6c4ec856"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"modified_by"</span><span class="p">:</span><span class="w"> </span><span class="s2">"d57c10f5-639d-5160-9c81-8a0c6c4ec856"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"f848277c-5398-58f8-a82a-72397af2d450"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"role_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a58de6d3-f52c-5080-b79b-a601a647ac85"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ada@passbolt.com"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"active"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="nl">"deleted"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="nl">"created"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-04T12:05:44+00:00"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"modified"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-03-04T12:05:44+00:00"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"profile"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">User</span><span class="w"> </span><span class="err">profile</span><span class="w"> </span><span class="err">object</span><span class="w">
            </span><span class="nl">"groups_users"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4f2a3f6e-1a3f-4f4a-a523-46c6b6d0f763"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"group_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"05b68bd2-e4e8-4838-ac21-4661b27fb23b"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"f848277c-5398-58f8-a82a-72397af2d450"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"is_admin"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"created"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-04-08T12:44:44+00:00"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6809e727-1219-4cfa-a201-1d3e997ca351"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"group_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"73479f22-b387-4d4e-b625-b1cc0b7ed116"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"f848277c-5398-58f8-a82a-72397af2d450"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"is_admin"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"created"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-04-08T12:10:03+00:00"</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="nl">"role"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a58de6d3-f52c-5080-b79b-a601a647ac85"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Logged in user"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"created"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-07-04T13:39:25+00:00"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"modified"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-07-04T13:39:25+00:00"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"gpgkey"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"04481719-5d9d-5e22-880a-a6b9270601d2"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"f848277c-5398-58f8-a82a-72397af2d450"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"armored_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-----BEGIN PGP PUBLIC KEY BLOCK-----"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"bits"</span><span class="p">:</span><span class="w"> </span><span class="mi">4096</span><span class="p">,</span><span class="w">
                </span><span class="nl">"uid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Ada Lovelace </span><span class="se">\u</span><span class="s2">003Cada@passbolt.com</span><span class="se">\u</span><span class="s2">003E"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"key_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5D9B054F"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"fingerprint"</span><span class="p">:</span><span class="w"> </span><span class="s2">"03F60E958F4CB29723ACDF761353B5B15D9B054F"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RSA"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"expires"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-08-09T12:48:31+00:00"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"key_created"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-09T12:48:31+00:00"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"deleted"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
                </span><span class="nl">"created"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-04-04T12:05:49+00:00"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"modified"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-04-04T12:05:49+00:00"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"last_logged_in"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<div class="message notice">
    <p>
    Take a note of the <code>user_count</code> key under group type AROs as that‚Äôs the exact number of secrets you‚Äôll need to send in order to share a resource with that group.
    </p>
    
</div>

<h2 id="sharing-a-resource">Sharing a Resource</h2>

<p>Sharing a Resource involves the following steps.</p>

<ol>
  <li>Get the id of the Resource you want to share.</li>
  <li>Get the id of the ARO you want to share it with.</li>
  <li>Encrypt the plaintext secret for all users using their public keys.</li>
  <li>Send the ASCII armored encrypted message for each of the affected users to the API.</li>
</ol>

<p>The payload takes a json object with keys for ‚Äúpermissions‚Äù and ‚Äúsecrets‚Äù. The ‚Äúpermission‚Äù key contains a json array where each object represents a <a href="/api/permissions">Permission</a> object for a user. While the ‚Äúsecrets‚Äù key contains a json array where each object represents a Secret object. At the very least, it contains the user_id and OpenPGP encrypted armored message.</p>

<p>To generate the encrypted message, you can use</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo</span> &lt;plaintext_password&gt; | gpg <span class="nt">-r</span> &lt;gpg_uid&gt; <span class="nt">-e</span> <span class="nt">-a</span>
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">search-aros</code> endpoint described above outputs the gpg details for individual users like their <code class="language-plaintext highlighter-rouge">armored_key</code>, <code class="language-plaintext highlighter-rouge">uid</code>, <code class="language-plaintext highlighter-rouge">key_id</code> and <code class="language-plaintext highlighter-rouge">fingerprint</code>. For Groups, you can make a GET request to <code class="language-plaintext highlighter-rouge">/groups/&lt;group_id&gt;.json</code> endpoint. For more info, check the <a href="/api/groups/read">View a group</a> page.</p>

<div class="message notice">
    <p>
    Based on the trust level of the public key gpg might complain about <code>There is no assurance this key belongs to the named user</code> If you trust the key, you can proceed by responding ‚Äòy‚Äô
    </p>
    
</div>

<p>Upon confirmation, gpg outputs the ascii armored message</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo</span> &lt;plaintext_password&gt; | gpg <span class="nt">-r</span> &lt;gpg_uid&gt; <span class="nt">-e</span> <span class="nt">-a</span>

<span class="nt">-----BEGIN</span> PGP MESSAGE-----

hQIMAxWrZ+ffF0kbARAAxGsQGv+ev9YNepCSmZKgVyLz9wtGmdy9In/nbVDPds3k
RSIrq5w9bNEx2h3HCdoR1tb5mii57GZ4kkqj/vN0dZRxbMJi7GAZuoPq+0N/KyKW
8MUlauobLsPmRW5HNbR5qMr8M3362nYsqDfDq+hJYng6Dg50Jpo3nTZmDqiLfcgz
n8x4i8BlNjZcy1DYOuQPP9CYSAnaK3QiFPIlaW3eJl9lkgpzlBirJLqPkwNcrB2V
BsVjjqIUnYFMZMe6ttm+JYNX4x8jjOAxOTWJeT8Do4nwyAuXgMoUL7YpDrPMb93F
AhNZs9WlF43Fh5UhpaZo0fagc3nNWPIXlNL7zGBPhM1U53oOer+CqGWlrEFaFfaf
+ImVZkiodITchymABK5CW4/YvwBQec7uLQcj+JC2IpsHKflar+43q6wVI5lwTvb7
p499DLdFmRyGZtbtgX5FhKWJWLvRxhGq3b5D5Wfix8S9kq4lyQArM4kkb1AT3u1j
diriLrRuJRz6BpRSat2WiAxh1moBf9/E7ymZe2Goi0F4sdtBoRwWbMoG3QMAWxNd
pHufLw57IjasIE8b4zlVnyodVrfaNAKnuQfCIl0Ocq6QP+FkQPZ9p2g3V/DIjh1h
qaEoKyzbQ83IGXyas5hYXJQtdJRiQCdBxpME00BFV+Gcsay2JPmjndsA/8U21E/S
QQG/c0kJXrdOsSwhDuu1ssCn79ayjoWo1OT70+Mg0yygeEgokVGHdp1O5vS9BTmo
NUYjWplniE9MhkzVaYqjng8n
<span class="o">=</span>2F87
<span class="nt">-----END</span> PGP MESSAGE-----
</code></pre></div></div>

<p>This needs to be done for each user gaining access to the secret
So the request body will look like</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"permissions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"is_new"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"aro"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Group"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"aro_foreign_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"36563004-3f25-50c0-b22e-6554c3ccc4e7"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"aco"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Resource"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"aco_foreign_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8e3874ae-4b40-590b-968a-418f704b9d9a"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="mi">7</span><span class="w">
    </span><span class="p">}],</span><span class="w">
  </span><span class="nl">"secrets"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8d04cf98-716b-5f6d-9fe8-c130f8992646"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"data"</span><span class="p">:</span><span class="s2">"-----BEGIN PGP MESSAGE-----"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h3 id="simulate-sharing">Simulate Sharing</h3>

<p>Passbolt API allows you to simulate a share before actually going through with this. This way you can see if the 
params pass the validation checks. To simulate sharing a resource 
you can make a <code class="language-plaintext highlighter-rouge">POST</code> request to <code class="language-plaintext highlighter-rouge">/share/simulate/resource/&lt;resourceId&gt;.json</code> where <code class="language-plaintext highlighter-rouge">resourceId</code> is the id of the 
<a href="/api/resources">Resource</a> you wish to share.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /share/simulate/resource/&lt;resourceId&gt;.json?api-version=v2
</code></pre></div></div>

<p>If the resource can be shared safely, this returns an associative array that contains a list of new users who 
will have access to the resource and a list of users who will lose their access. These lists can be used to 
encrypt the secrets for the users who get access and to remove the secrets of the users who lost their access.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"header"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"499657b1-463c-49e3-99d0-7d4bca7392c2"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"success"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"servertime"</span><span class="p">:</span><span class="w"> </span><span class="mi">1554972001</span><span class="p">,</span><span class="w">
        </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"app_share_dryRun_success"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7df37cb5-cfb9-57c2-a7a5-b65c9f573de0"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The operation was successful."</span><span class="p">,</span><span class="w">
        </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"</span><span class="se">\/</span><span class="s2">share</span><span class="se">\/</span><span class="s2">simulate</span><span class="se">\/</span><span class="s2">resource</span><span class="se">\/</span><span class="s2">8e3874ae-4b40-590b-968a-418f704b9d9a.json?api-version=v2"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"code"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"body"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"changes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"added"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"&lt;uuid1&gt;"</span><span class="p">,</span><span class="w"> </span><span class="s2">"&lt;uuid2&gt;"</span><span class="p">],</span><span class="w">
            </span><span class="nl">"removed"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"&lt;uuid3&gt;"</span><span class="p">,</span><span class="w"> </span><span class="s2">"&lt;uuid4&gt;"</span><span class="p">]</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h3 id="final-sharing">Final sharing</h3>

<p>If the simulation returns a success response, you can go ahead with sharing your resource. To share a resource 
you can make a <code class="language-plaintext highlighter-rouge">PUT</code> request to <code class="language-plaintext highlighter-rouge">/share/simulate/resource/&lt;resourceId&gt;.json</code> where <code class="language-plaintext highlighter-rouge">resourceId</code> is the id of the 
<a href="/api/resources">Resource</a> you wish to share.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PUT /share/resource/&lt;resourceId&gt;.json?api-version=v2
</code></pre></div></div>

<p>The request schema is same as above while the response can be either of the following.</p>

<table class="table-parameters">
    <thead>
        <tr>
            <th>Code</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>200</td>
            <td>OK<br />
            The resource is shared successfully.</td>
        </tr>
        <tr>
            <td>400</td>
            <td>Bad Request<br />
            The resourceId supplied is not a valid UUID</td>
        </tr>
        <tr>
            <td>403</td>
            <td>Authentication Failure<br />
            The user making the request is not authenticated</td>
        </tr>
        <tr>
            <td>404</td>
            <td>Not Found<br />
            The resource either does not exist or<br />
            The user does not have access permission or<br />
            Invalid number of secrets sent.
            </td>
        </tr>
    </tbody>
</table>

                    <div class="last-updated" markdown="1">
<h3>Last updated</h3>
This article was last updated on 
April
23rd,
2019.
</div>
                    </div>

                    <div class="col4 last" markdown="1">
                    <div class="tldr" style="margin-top:3em;">
                        <p>If you are familiar with the high level API concepts and only looking for the endpoint implementation details,
                            there is a repository with the latest OpenAPI 2.0 specifications (compatible with Swagger).</p>
                        <a href="https://github.com/passbolt/passbolt_openapi_specs" class="button primary">
                            OpenAPI Specs
                        </a>
                    </div>
                    </div>
                    </div>

                </article>
            </div>
        </div>
    </div>

        <footer>
        <div class="footer">
            <ul class="footer-links">
                <li><a href="https://www.passbolt.com/licence">Terms</a></li>
                <li><a href="https://www.passbolt.com/privacy">Privacy</a></li>
                <li><a href="https://www.passbolt.com/credits">Credits</a></li>
                <li><a href="https://careers.passbolt.com">Careers</a></li>
            </ul>
        </div>
    </footer>
    <div id="cookies-eu-banner" class="visually-hidden">
        üç™ &nbsp; Do you accept cookies for statistical purposes?
        <a href="https://www.passbolt.com/privacy" id="cookies-eu-more">(Read more)</a>
        <a class="button primary" id="cookies-eu-accept">Accept</a>
        <a id="cookies-eu-reject">No thanks!</a>
    </div>


</div>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-23506466-3"></script>
<script src="https://code.jquery.com/jquery-3.5.0.slim.min.js" integrity="sha384-/IFzzQmt1S744I+IQO4Mc1uphkxbXt1tEwjQ/qSw2p8pXWck09sLvqHmKDYYwReJ" crossorigin="anonymous"></script>
<script src="https://help.passbolt.com/assets/js/cookies-eu-banner.js"></script>
<script src="https://help.passbolt.com/assets/js/analytics.js"></script>
<script src="https://help.passbolt.com/assets/js/greedynav.js"></script>
</body>
</html>
