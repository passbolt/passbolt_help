<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Passbolt Help | How to configure SSO with Microsoft (Alpha)</title>
    <!--
             ____                  __          ____
            / __ \____  _____ ____/ /_  ____  / / /_
           / /_/ / __ `/ ___/ ___/ __ \/ __ \/ / __/
          / ____/ /_/ (__  |__  ) /_/ / /_/ / / /_
         /_/    \__,_/____/____/_.___/\____/_/\__/

         Open source password manager for teams
         ¬© 2019 Passbolt SA

     -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta property="og:image" content="https://help.passbolt.com/assets/img/background/og_preview.jpg" />
    <meta property="og:title" content="How to configure SSO with Microsoft (Alpha)" />
    <meta property="og:description" content="" />
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/help.min.css">
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/highlight.css">
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/cookie-eu-banner.css">
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/custom.css">
    <link rel="canonical" href="https://help.passbolt.com/configure/sso/azure">
    <link rel="shortcut icon" type="image/x-icon" href="https://help.passbolt.com/assets/favicon.ico" />
    <link rel="alternate" type="application/rss+xml" title="Passbolt | Help" href="https://help.passbolt.com/feed.xml">
</head>


<body>
    <div id="container" class="help page background">
            <header>
        <div class="header first ">
            <nav class="greedy">
                <div class="top navigation primary">
                    <ul class="links clearfix">
                        <li class="home with-text"><a href="http://www.passbolt.com/"><span>home</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/services"><span>pricing</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/roadmap"><span>roadmap</span></a></li>
                        <li class="left"><a href="https://community.passbolt.com/"><span>forum</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/blog"><span>blog</span></a></li>
                        <li class="left selected"><a href="https://help.passbolt.com/"><span>help</span></a></li>
                        <li class="left"><a href="https://demo.passbolt.com" class="highlighted" target="_blank" rel="noopener"><span>try it!</span></a></li>
                    </ul>
                    <button class="hidden" count="0">more</button>
                    <ul class="hidden-links hidden"></ul>
                </div>
            </nav>
        </div>
    </header>
    <div class="header second">
        <div class="col1">
            <div class="logo no-img">
                <h1><span>Passbolt</span></h1>
            </div>
        </div>
        <div class="col2 search-wrapper">
            <h2 class="visuallyhidden">Help Search</h2>
            <div>
                <form class="search ready" action="/search.html" method="get">
                    <div class="input required">
                        <label for="search-box">Search</label>
                        <input id="search-box" name="query" maxlength="64" placeholder="Help search" class="fuzzy-search" type="search">
                    </div>
                    <button value="search">
                        <i class="fa fa-fw fa-search"></i>
                        <span class="text visuallyhidden">search</span>
                    </button>
                </form>
            </div>
        </div>
        <div class="col3">
            <div class="edit-on-github">
                <a href="https://github.com/passbolt/passbolt_help/edit/master/_posts/configure/2023-01-18-configure-sso-azure.md" class="button">
                    <i class="fa fa-github-alt fa-fw"></i> Edit on github</a>
            </div>
        </div>
    </div>

        <div class="panel main" aria-label="Content">
            <div class="panel left">
                
                









<div class="navigation-help" role="navigation">
    <ul>
        <li>
            <h2>Configure</h2>
        </li>
        
        <li >
            <a href="https://help.passbolt.com/configure/https">Configure HTTPS</a>
        </li>
        
        
        <li >
            <a href="https://help.passbolt.com/configure/ldap/setup">Configure LDAP</a>
        </li>
        
        
        <li >
            <a href="https://help.passbolt.com/configure/account-recovery">Configure Account Recovery</a>
        </li>
        
        
        <li >
            <a href="https://help.passbolt.com/configure/sso/azure">Configure SSO</a>
        </li>
        
        
        <li >
            <a href="https://help.passbolt.com/configure/ldap/ldap-with-ssl">Configure LDAP with ssl</a>
        </li>
        
        
        <li >
            <a href="https://help.passbolt.com/configure/ldap/ldap-common-sync-error-messages">Troubleshoot LDAP sync errors</a>
        </li>
        
        
        <li >
            <a href="https://help.passbolt.com/configure/mfa/yubikey">Configure Yubikey</a>
        </li>
        
        
        <li >
            <a href="https://help.passbolt.com/configure/mfa/duo">Configure Duo</a>
        </li>
        
        
        <li >
            <a href="https://help.passbolt.com/configure/notification/email">Configure Email Notifications</a>
        </li>
        
        
        <li >
            <a href="https://help.passbolt.com/configure/email/setup">Configure Email providers</a>
        </li>
        
        
        <li >
            <a href="https://help.passbolt.com/faq/hosting/why-email-not-sent">Troobleshoot Email config</a>
        </li>
        
        
        <li >
            <a href="https://help.passbolt.com/configure/environment/reference">Environment variable reference</a>
        </li>
        
        
        <li >
            <a href="https://help.passbolt.com/configure/database/credentials">Update database credentials</a>
        </li>
        
        
    </ul>
</div>








                
            </div>
            <div class="panel middle" data-spy="scroll" data-target=".scrollspy">
                <div class="grid grid-responsive-12">
                    <article>
                        <div class="row" id="introduction">
    <div class="col12">
        <div class="breadcrumbs">
            <ul>
                <li>
                    <div class="main-cell">
                        <a href="https://www.passbolt.com"><span>home</span></a>
                    </div>
                </li>
                <li>
                    <div class="main-cell">
                        <a href="/"><span>help</span></a>
                    </div>
                </li>
                
                
                <li>
                    <div class="main-cell">
                        <a href="https://help.passbolt.com/configure"><span>configure</span></a>
                    </div>
                </li>
                
                <li>
                    <div class="main-cell">
                        <a href="https://help.passbolt.com/configure/sso"><span>sso</span></a>
                    </div>
                </li>
                
                
                
                
                <li>
                    <div class="main-cell">
                        <a href="https://help.passbolt.com/configure/sso/azure.html"><span>azure</span></a>
                    </div>
                </li>
                
            </ul>
        </div>
    </div>
</div>

                        <div class="row" markdown="1">
<div class="col7" markdown="1">
<h1>How to configure SSO with Microsoft (Alpha)</h1>
</div>
</div>

                        
<div class="row">
  <div class="col7">

    <div class="message warning">
    <p>
        <strong>Attention</strong>: This feature is currently in Alpha, and available only in Passbolt Pro Edition.
    </p>
    
</div>

    <p>Since version 3.9 Passbolt Pro Edition, supports SSO with Microsoft via Azure AD.</p>

    <figure>
    <img src="https://help.passbolt.com/assets/img/help/2023/01/sso-passbolt-login.png" alt="SSO with Azure (Alpha)" style="max-width:;" />
    <span class="legend">fig. SSO with Azure (Alpha)</span>
</figure>

    <h2 id="why-is-it-in-alpha-what-does-it-mean">Why is it in Alpha? What does it mean?</h2>

    <div class="message notice">
    <p>
    TL;DR: The feature is in alpha and for Pro Edition customer only because it is undergoing real life testing and
a security audit.
    </p>
    
</div>

    <p>The feature is currently disabled by default and requires passbolt browser extension version
3.9.1 (Note: this extension will be published on 19th of January 2023). To test latest changes you can also build the 
latest extension <a href="https://github.com/passbolt/browser_extension">built from source</a>.</p>

    <p>The feature is provided to customers who want to test this first version and provide feedback. Feel free to report
issues at <a href="mailto:support@passbolt.com">support@passbolt.com</a> or on the <a href="https://community.passbolt.com">community forum</a>.</p>

    <p>The goal is to publish a ‚ÄúBeta‚Äù version with 3.10 or 3.11, which will be available without being hidden behind a 
feature flag. It will be visible directly in the UI. Then at end of february the feature will undergo an independent 
3rd party security audit by Cure53, and once the security and  community reported issue fixes are rolled out (if any), 
the ‚ÄúBeta‚Äù label will be lifted out. It will then be made available in Passbolt Cloud.</p>

    <h2 id="how-does-it-work">How does it work?</h2>

    <p>In short Passbolt SSO leverage Azure OAuth2/OpenID on top of the existing <a href="/api/authentication">challenge-based authentication</a>.
The user by logging in Microsoft unlock a key stored server side needed to decrypt the secret key passphrase twice encrypted
with a non-extractable symetric key stored in the browser extension local storage client side.</p>

    <p>To understand which user flows are supported currently, the risks analysis and how it works in practice please read the 
<a href="https://docs.google.com/document/d/1S58TonJ2uXwkaKl7WwLzTzmwJGiSJdhlqP-xbmxFBd0/edit#heading=h.5z0ujk6vpr1j">developer documentation</a>.</p>

    <h2 id="how-to-enable-sso-azure-plugin">How to enable SSO Azure plugin?</h2>

    <div class="message warning">
    <p>
        <strong>Attention</strong>: This feature requires HTTPS to work.
    </p>
    
</div>

    <p>If you use docker you can enable the SSO plugin using the <code class="language-plaintext highlighter-rouge">PASSBOLT_PLUGINS_SSO_ENABLED=1</code>. Otherwise you will need
to edit your <code class="language-plaintext highlighter-rouge">passbolt.php</code> file to add the following:</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// Locate this section
'passbolt' =&gt; [
    // and add...
    'sso' =&gt; [
        'enabled' =&gt; true
    ],
</code></pre></div>    </div>

    <h2 id="how-to-configure-the-plugin">How to configure the plugin?</h2>

    <p>Open both Azure portal and passbolt:</p>
    <ul>
      <li>Once the plugin enabled you will need to go the administration section of your passbolt instance and then to the ‚ÄúSingle Sign On‚Äù section.</li>
      <li>You will need to also login to <a href="https://portal.azure.com">Azure Portal</a>.</li>
    </ul>

    <figure>
    <img src="https://help.passbolt.com/assets/img/help/2023/01/sso-passbolt-admin.png" alt="Passbolt administration" style="max-width:;" />
    <span class="legend">fig. Passbolt administration</span>
</figure>

    <p>You must ensure users are present both in passbolt and Azure AD, the email is used to correlate accounts.</p>
    <ul>
      <li>Users that are not present in Azure AD but are present in passbolt will not be able to use SSO (a message on microsoft side will be shown).</li>
      <li>Users that are not present in passbolt but are present in Azure AD will not be able to login in passbolt (a message on passbolt side will be shown).</li>
    </ul>

    <figure>
    <img src="https://help.passbolt.com/assets/img/help/2023/01/sso-0-azure-home.png" alt="Azure Portal" style="max-width:;" />
    <span class="legend">fig. Azure Portal</span>
</figure>

    <h3 id="configure-azure-ad">Configure Azure AD</h3>
    <p>In your Azure AD portal:</p>
    <ul>
      <li>Go to Azure Directory service (or set one up)
        <ul>
          <li>Make sure your user email in Azure Directory and matches the one in passbolt</li>
        </ul>
      </li>
      <li>Copy your tenant id (a UUID) and paste it in passbolt</li>
      <li>Go to App Registrations &gt; New registration OR ‚Äú+ Add‚Äù &gt; ‚ÄúApp Registration‚Äù</li>
    </ul>

    <figure>
    <img src="https://help.passbolt.com/assets/img/help/2023/01/sso-1-azure-directory.png" alt="Azure AD" style="max-width:;" />
    <span class="legend">fig. Azure AD</span>
</figure>

    <p>Register a new application</p>
    <ul>
      <li>Give it a Name such as ‚ÄúPassbolt SSO‚Äù</li>
      <li>Select the supported account type you desire. ‚ÄúAccounts in this organizational directory only‚Äù is a good default.</li>
      <li>Copy the redirect url from Passbolt to Azure, it should be something like <code class="language-plaintext highlighter-rouge">https://yourdomain.com/sso/azure/redirect</code>.</li>
      <li>In ‚ÄúSelect a platform‚Äù, select ‚ÄúWeb‚Äù</li>
      <li>Click register, you should be back on the Azure application page</li>
      <li>Copy the application (client) ID back to your passbolt instance</li>
    </ul>

    <figure>
    <img src="https://help.passbolt.com/assets/img/help/2023/01/sso-2-create-app.png" alt="App registration" style="max-width:;" />
    <span class="legend">fig. App registration</span>
</figure>

    <p>Add a secret for the application</p>
    <ul>
      <li>On the Azure application page, click on ‚ÄúCertificate and secrets‚Äù</li>
      <li>Click on ‚ÄúNew client secret‚Äù</li>
      <li>Choose a name like ‚ÄúPassbolt SSO Secret‚Äù</li>
      <li>Select an expiry date</li>
      <li>Copy the secret value and expiry back to your passbolt instance</li>
    </ul>

    <figure>
    <img src="https://help.passbolt.com/assets/img/help/2023/01/sso-4-create-secret.png" alt="App secret creation" style="max-width:;" />
    <span class="legend">fig. App secret creation</span>
</figure>

    <p>In passbolt:</p>
    <ul>
      <li>Click save settings</li>
      <li>A dialog will open with Microsoft button, click on it</li>
      <li>A popup will open asking your to perform the authentication with microsoft</li>
      <li>Once the authentication is successful you can save the settings</li>
      <li>Once the settings saved, you can log out, you should then see a SSO option</li>
    </ul>

    <figure>
    <img src="https://help.passbolt.com/assets/img/help/2023/01/sso-passbolt-test.png" alt="Passbolt SSO test settings" style="max-width:;" />
    <span class="legend">fig. Passbolt SSO test settings</span>
</figure>

    <p>Please note that users must successfully perform a login using their passphrase <em>after SSO has been activated</em>
in order for the option to be proposed to them at login.</p>

    <div class="last-updated">
      <h3>Last updated</h3>
      <p>This article was last updated on 
January
18th,
2023.</p>
    </div>

  </div>
  <div class="col4 last push1">

    <div class="message tldr notice">
    <p>Are you experiencing issues with Passbolt Pro Edition?</p>
    <a href="mailto:contact@passbolt.com" class="button primary">Contact Pro support</a>
    <p>or <a href="https://community.passbolt.com">ask the community</a></p>

</div>

  </div>
</div>

                    </article>
                </div>
            </div>
        </div>
            <footer>
        <div class="footer">
            <ul class="footer-links">
                <li><a href="https://www.passbolt.com/licence">Terms</a></li>
                <li><a href="https://www.passbolt.com/privacy">Privacy</a></li>
                <li><a href="https://www.passbolt.com/credits">Credits</a></li>
                <li><a href="https://careers.passbolt.com">Careers</a></li>
            </ul>
        </div>
    </footer>
    <div id="cookies-eu-banner" class="visually-hidden">
        üç™ &nbsp; Do you accept cookies for statistical purposes?
        <a href="https://www.passbolt.com/privacy" id="cookies-eu-more">(Read more)</a>
        <a class="button primary" id="cookies-eu-accept">Accept</a>
        <a id="cookies-eu-reject">No thanks!</a>
    </div>


    </div>
    <script src="https://consent.cookiebot.com/uc.js" data-cbid="900808a8-f178-4994-b2ad-66bf3ccca5f7" data-blockingmode="auto" strategy="beforeInteractive"></script>
<script src="https://help.passbolt.com/assets/js/matomo-tag-manager.js"></script>
<script src="https://help.passbolt.com/assets/js/matomo-analytics.js"></script>
<script src="https://code.jquery.com/jquery-3.5.0.slim.min.js" integrity="sha384-/IFzzQmt1S744I+IQO4Mc1uphkxbXt1tEwjQ/qSw2p8pXWck09sLvqHmKDYYwReJ" crossorigin="anonymous"></script>
<script src="https://help.passbolt.com/assets/js/analytics.js"></script>
<script src="https://help.passbolt.com/assets/js/greedynav.js"></script>
</body>

</html>