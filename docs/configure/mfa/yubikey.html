<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Passbolt Help | How to configure passbolt to use Yubikey OTP</title>
    <!--
             ____                  __          ____
            / __ \____  _____ ____/ /_  ____  / / /_
           / /_/ / __ `/ ___/ ___/ __ \/ __ \/ / __/
          / ____/ /_/ (__  |__  ) /_/ / /_/ / / /_
         /_/    \__,_/____/____/_.___/\____/_/\__/

         Open source password manager for teams
         ¬© 2019 Passbolt SA

     -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta property="og:image" content="https://help.passbolt.com/assets/img/background/og_preview.jpg" />
    <meta property="og:title" content="How to configure passbolt to use Yubikey OTP" />
    <meta property="og:description" content="" />
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/help.min.css">
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/highlight.css">
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/cookie-eu-banner.css">
    <link rel="canonical" href="https://help.passbolt.com/configure/mfa/yubikey">
    <link rel="shortcut icon" type="image/x-icon" href="https://help.passbolt.com/assets/favicon.ico" />
    <link rel="alternate" type="application/rss+xml" title="Passbolt | Help" href="https://help.passbolt.com/feed.xml">

</head>


<body>
    <div id="container" class="help page background">
            <header>
        <div class="header first ">
            <nav class="greedy">
                <div class="top navigation primary">
                    <ul class="links clearfix">
                        <li class="home with-text"><a href="http://www.passbolt.com/"><span>home</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/services"><span>pricing</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/roadmap"><span>roadmap</span></a></li>
                        <li class="left"><a href="https://community.passbolt.com/"><span>forum</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/blog"><span>blog</span></a></li>
                        <li class="left selected"><a href="https://help.passbolt.com/"><span>help</span></a></li>
                        <li class="left"><a href="https://demo.passbolt.com" class="highlighted" target="_blank" rel="noopener"><span>try it!</span></a></li>
                    </ul>
                    <button class="hidden" count="0">more</button>
                    <ul class="hidden-links hidden"></ul>
                </div>
            </nav>
        </div>
    </header>
    <div class="header second">
        <div class="col1">
            <div class="logo no-img">
                <h1><span>Passbolt</span></h1>
            </div>
        </div>
        <div class="col2 search-wrapper">
            <h2 class="visuallyhidden">Help Search</h2>
            <div>
                <form class="search ready" action="/search.html" method="get">
                    <div class="input required">
                        <label for="search-box">Search</label>
                        <input id="search-box" name="query" maxlength="64" placeholder="Help search" class="fuzzy-search" type="search">
                    </div>
                    <button value="search">
                        <i class="fa fa-fw fa-search"></i>
                        <span class="text visuallyhidden">search</span>
                    </button>
                </form>
            </div>
        </div>
        <div class="col3">
            <div class="edit-on-github">
                <a href="https://github.com/passbolt/passbolt_help/edit/master/_posts/configure/2018-11-14-configure-mfa-yubikey.md" class="button">
                    <i class="fa fa-github-alt fa-fw"></i> Edit on github</a>
            </div>
        </div>
    </div>

        <div class="panel main" aria-label="Content">
            <div class="panel left">
                
                









<div class="navigation-help" role="navigation">
    <ul>
        <li>
            <h2>Configure</h2>
        </li>
        
        <li >
            <a href="https://help.passbolt.com/configure/ldap/setup">Configure LDAP</a>
        </li>
        
        
        <li class="selected"
            >
            <a href="https://help.passbolt.com/configure/mfa/yubikey">Configure Yubikey</a>
        </li>
        
        
        <li >
            <a href="https://help.passbolt.com/configure/mfa/duo">Configure Duo</a>
        </li>
        
        
        <li >
            <a href="https://help.passbolt.com/configure/notification/email">Configure Email Notifications</a>
        </li>
        
        
        <li >
            <a href="https://help.passbolt.com/configure/ldap/ldap-with-ssl">Configure LDAP with ssl</a>
        </li>
        
        
        <li >
            <a href="https://help.passbolt.com/configure/ldap/ldap-common-sync-error-messages">Troubleshoot LDAP sync errors</a>
        </li>
        
        
        <li >
            <a href="https://help.passbolt.com/configure/environment/reference">Environment variable reference</a>
        </li>
        
        
        <li >
            <a href="https://help.passbolt.com/configure/email/setup">Configure Email providers</a>
        </li>
        
        
        <li >
            <a href="https://help.passbolt.com/configure/https">Configure HTTPS</a>
        </li>
        
        
        <li >
            <a href="https://help.passbolt.com/faq/hosting/why-email-not-sent">Troobleshoot Email config</a>
        </li>
        
        
    </ul>
</div>








                
            </div>
            <div class="panel middle" data-spy="scroll" data-target=".scrollspy">
                <div class="grid grid-responsive-12">
                    <article>
                        <div class="row" id="introduction">
    <div class="col12">
        <div class="breadcrumbs">
            <ul>
                <li>
                    <div class="main-cell">
                        <a href="https://www.passbolt.com"><span>home</span></a>
                    </div>
                </li>
                <li>
                    <div class="main-cell">
                        <a href="/"><span>help</span></a>
                    </div>
                </li>
                
                
                <li>
                    <div class="main-cell">
                        <a href="https://help.passbolt.com/configure"><span>configure</span></a>
                    </div>
                </li>
                <li>
                    <div class="main-cell">
                        <a href="https://help.passbolt.com/configure/mfa"><span>mfa</span></a>
                    </div>
                </li>
                
                
                
                <li>
                    <div class="main-cell">
                        <a href="https://help.passbolt.com/configure/mfa/yubikey.html"><span>yubikey</span></a>
                    </div>
                </li>
                
            </ul>
        </div>
    </div>
</div>

                        <div class="row" markdown="1">
<div class="col7" markdown="1">
<h1>How to configure passbolt to use Yubikey OTP</h1>
</div>
</div>

                        <div class="row">
  <div class="col7">

    <p>Passbolt Pro Edition since v2.5 supports Yubikey OTP as a multi factor authentication option.
Yubico¬†OTP¬†is a simple authentication mechanism that is supported by all YubiKeys out of the box.</p>

    <figure>
    <img src="https://help.passbolt.com/assets/img/help/2018/11/mfa-yubikey-login.jpg" alt="Using a Yubikey at login" style="max-width:450px;" />
    <span class="legend">fig. Using a Yubikey at login</span>
</figure>

    <div class="message warning">
    <p>
        <strong>Important:</strong> Multi Factor Authentication is part of <a href="https://www.passbolt.com/pricing/pro">Passbolt Pro</a> only and is not available in the Community Edition.
    </p>
    
</div>

    <h2 id="security-considerations">Security considerations</h2>

    <p>It is important to enable and setup at least one additional multi factor authentication provider in 
case the user lose its Yubikey or the the Yubicloud service becomes temporarily not available.</p>

    <p>During a login attempt the passbolt will check if the key ID used by the user is the same that was 
used during setup. To change key (if the key was lost for example) a user will need to first disable 
the Yubikey provider in their settings.</p>

    <h2 id="get-a-yubikey-cloud-api-key">Get a Yubikey cloud api key</h2>

    <p>In order to use Yubikey OTP you need get an API key for Yubicloud, Yubico‚Äôs web service for verifying OTPs. 
Please note that while it is possible to <a href="https://developers.yubico.com/Software_Projects/Yubico_OTP/YubiCloud_Validation_Servers/">host yourself the OTP validation server</a>, 
this approach is not supported by Passbolt at the moment.</p>

    <figure>
    <img src="https://help.passbolt.com/assets/img/help/2018/11/mfa-yubikey-admin.png" alt="Yubicloud registration" style="max-width:550px;" />
    <span class="legend">fig. Yubicloud registration</span>
</figure>

    <p>Before using YubiCloud, you need to get an API key from <a href="https://upgrade.yubico.com/getapikey/">upgrade.yubico.com</a> 
in order to prevent misuse of the service. You will need to authenticate yourself using a Yubikey One-Time Password 
and provide your e-mail address as a reference, as well as read and accept the terms of service.</p>

    <h2 id="make-sure-yubicloud-urls-are-whitelisted">Make sure YubiCloud urls are whitelisted</h2>

    <p>In order to verify a Yubikey OTP passbolt will need to connect to YubiCloud.
If you prevent outgoing connection from Passbolt server to the following domains:</p>
    <ul>
      <li>api.yubico.com</li>
      <li>api2.yubico.com</li>
      <li>api3.yubico.com</li>
      <li>api4.yubico.com</li>
      <li>api5.yubico.com</li>
    </ul>

    <p>One or more of these domains may be used to try to validate an OTP.</p>

    <h2 id="set-the-configuration-in-passbolt">Set the configuration in passbolt</h2>

    <p>You can configure Yubikey OTP using either the admin interface, config files or environment variables. If multiple settings providers are used the settings in the admin interface will override the one used in files. Similarly the settings in files will override environment variables.</p>

    <h3 id="using-admin-user-interface">Using admin user interface</h3>

    <p>Since v2.6 a user interface is provided for administrators to setup MFA providers.
Click on ‚Äúadministration‚Äù in the top menu, then ‚Äúmulti factor authentication‚Äù on the left menu.
You can then enable or disable the Yubikey provider by providing the user id and secret key that
you gathered in the previous steps. Click ‚Äúsave settings‚Äù when you are done.</p>

    <figure>
    <img src="https://help.passbolt.com/assets/img/help/2018/12/AD_mfa_org_settings_yubikey.png" alt="MFA organization settings for Yubikey" style="max-width:550px;" />
    <span class="legend">fig. MFA organization settings for Yubikey</span>
</figure>

    <h3 id="using-environment-variables">Using environment variables</h3>

    <table class="table-parameters">
<thead>
    <tr>
        <th>Variable name</th>
        <th>Description</th>
        <th>Type</th>
    </tr>
</thead>
<tbody>
    <tr>
        <td>PASSBOLT_PLUGINS_MFA_YUBIKEY_SECRETKEY</td>
        <td>Yubicloud secret key</td>
        <td>string</td>
    </tr>
    <tr>
        <td>PASSBOLT_PLUGINS_MFA_YUBIKEY_CLIENTID</td>
        <td>Yubicloud client id</td>
        <td>integer</td>
    </tr>
</tbody>
</table>
    <p><br /></p>

    <p>When you using docker to set these environment variable you can pass them as arguments,
like other variables such as the database name, for example:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker run --name passbolt \
             -p 80:80 \
             -p 443:443 \
             -e PASSBOLT_PLUGINS_MFA_YUBIKEY_CLIENTID=12345 \
             -e PASSBOLT_PLUGINS_MFA_YUBIKEY_SECRETKEY="xx/xxxxxx/xxxxxxxxxxxx=" \
</code></pre></div>    </div>

    <h3 id="using-config-file">Using config file</h3>

    <p>In your install directory you can add the following section in <code class="language-plaintext highlighter-rouge">config/passbolt.php</code></p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'plugins' =&gt; [
    'multiFactorAuthentication' =&gt; [
        'providers' =&gt; [
            'totp' =&gt; true,
            'duo' =&gt; false,
            'yubikey' =&gt; true
        ],
        'yubikey' =&gt; [
            'clientId' =&gt; '01234',
            'secretKey' =&gt; 'xx/xxxxxx/xxxxxxxxxxxx='
        ]
    ]
]
</code></pre></div>    </div>

    <h2 id="setting-yubikey-for-a-given-passbolt-user-account">Setting Yubikey for a given passbolt user account</h2>

    <p>Once you have a the Yubikey integration configured and Yubikey plugged in your computer you
can proceed with enabling Yubikey as provider for your user account. It is important you test
this to make sure the integration works.</p>

    <figure>
    <img src="https://help.passbolt.com/assets/img/help/2018/11/mfa-providers.png" alt="MFA provider selection for passbolt user" style="max-width:550px;" />
    <span class="legend">fig. MFA provider selection for passbolt user</span>
</figure>

    <p>When logged in passbolt go to your profile section and click on ‚ÄúMulti factor authentication‚Äù
in the left sidebar. You should see the list of providers that are enabled for this instance.
Click on the Yubikey provider. Passbolt will then prompt your to touch your Yubikey
to enter a one time password.</p>

    <p>The next time you try login from a new device, you will be presented with a Yubikey 
authentication prompt.</p>

    <figure>
    <img src="https://help.passbolt.com/assets/img/help/2018/11/mfa-yubikey-login2.png" alt="Login prompt" style="max-width:550px;" />
    <span class="legend">fig. Login prompt</span>
</figure>

    <div class="last-updated">
      <h3>Last updated</h3>
      <p>This article was last updated on 
November
15th,
2018.</p>
    </div>

  </div>
  <div class="col4 last push1">

    <div class="message tldr notice">
    <p>Are you experiencing issues with Passbolt Pro Edition?</p>
    <a href="mailto:contact@passbolt.com" class="button primary">Contact Pro support</a>
    <p>or <a href="https://community.passbolt.com">ask the community</a></p>

</div>

  </div>
</div>

                    </article>
                </div>
            </div>
        </div>
            <footer>
        <div class="footer">
            <ul class="footer-links">
                <li><a href="https://www.passbolt.com/licence">Terms</a></li>
                <li><a href="https://www.passbolt.com/privacy">Privacy</a></li>
                <li><a href="https://www.passbolt.com/credits">Credits</a></li>
                <li><a href="https://careers.passbolt.com">Careers</a></li>
            </ul>
        </div>
    </footer>
    <div id="cookies-eu-banner" class="visually-hidden">
        üç™ &nbsp; Do you accept cookies for statistical purposes?
        <a href="https://www.passbolt.com/privacy" id="cookies-eu-more">(Read more)</a>
        <a class="button primary" id="cookies-eu-accept">Accept</a>
        <a id="cookies-eu-reject">No thanks!</a>
    </div>


    </div>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-23506466-3"></script>
<script src="https://code.jquery.com/jquery-3.5.0.slim.min.js" integrity="sha384-/IFzzQmt1S744I+IQO4Mc1uphkxbXt1tEwjQ/qSw2p8pXWck09sLvqHmKDYYwReJ" crossorigin="anonymous"></script>
<script src="https://help.passbolt.com/assets/js/cookies-eu-banner.js"></script>
<script src="https://help.passbolt.com/assets/js/analytics.js"></script>
<script src="https://help.passbolt.com/assets/js/greedynav.js"></script>
</body>

</html>