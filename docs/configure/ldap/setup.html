<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Passbolt Help | Configure Ldap plugin</title>
    <!--
             ____                  __          ____
            / __ \____  _____ ____/ /_  ____  / / /_
           / /_/ / __ `/ ___/ ___/ __ \/ __ \/ / __/
          / ____/ /_/ (__  |__  ) /_/ / /_/ / / /_
         /_/    \__,_/____/____/_.___/\____/_/\__/

         Open source password manager for teams
         ¬© 2019 Passbolt SA

     -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta property="og:image" content="https://help.passbolt.com/assets/img/help/2018/09/AD_ldap_overview.png" />
    <meta property="og:title" content="Configure Ldap plugin" />
    <meta property="og:description" content="" />
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/help.min.css">
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/highlight.css">
    <link rel="stylesheet" href="https://help.passbolt.com/assets/css/cookie-eu-banner.css">
    <link rel="canonical" href="https://help.passbolt.com/configure/ldap/setup">
    <link rel="shortcut icon" type="image/x-icon" href="https://help.passbolt.com/assets/favicon.ico" />
    <link rel="alternate" type="application/rss+xml" title="Passbolt | Help" href="https://help.passbolt.com/feed.xml">

</head>


<body>
    <div id="container" class="help page background">
            <header>
        <div class="header first ">
            <nav class="greedy">
                <div class="top navigation primary">
                    <ul class="links clearfix">
                        <li class="home with-text"><a href="http://www.passbolt.com/"><span>home</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/services"><span>pricing</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/roadmap"><span>roadmap</span></a></li>
                        <li class="left"><a href="https://community.passbolt.com/"><span>forum</span></a></li>
                        <li class="left"><a href="https://www.passbolt.com/blog"><span>blog</span></a></li>
                        <li class="left selected"><a href="https://help.passbolt.com/"><span>help</span></a></li>
                        <li class="left"><a href="https://demo.passbolt.com" class="highlighted" target="_blank" rel="noopener"><span>try it!</span></a></li>
                    </ul>
                    <button class="hidden" count="0">more</button>
                    <ul class="hidden-links hidden"></ul>
                </div>
            </nav>
        </div>
    </header>
    <div class="header second">
        <div class="col1">
            <div class="logo no-img">
                <h1><span>Passbolt</span></h1>
            </div>
        </div>
        <div class="col2 search-wrapper">
            <h2 class="visuallyhidden">Help Search</h2>
            <div>
                <form class="search ready" action="/search.html" method="get">
                    <div class="input required">
                        <label for="search-box">Search</label>
                        <input id="search-box" name="query" maxlength="64" placeholder="Help search" class="fuzzy-search" type="search">
                    </div>
                    <button value="search">
                        <i class="fa fa-fw fa-search"></i>
                        <span class="text visuallyhidden">search</span>
                    </button>
                </form>
            </div>
        </div>
        <div class="col3">
            <div class="edit-on-github">
                <a href="https://github.com/passbolt/passbolt_help/edit/master/_posts/configure/2018-09-06-configure-ldap.md" class="button">
                    <i class="fa fa-github-alt fa-fw"></i> Edit on github</a>
            </div>
        </div>
    </div>

        <div class="panel main" aria-label="Content">
            <div class="panel left">
                
                









<div class="navigation-help" role="navigation">
    <ul>
        <li>
            <h2>Configure</h2>
        </li>
        
        <li >
            <a href="https://help.passbolt.com/configure/ldap/setup">Configure LDAP</a>
        </li>
        
        
        
        
        <li >
            <a href="https://help.passbolt.com/configure/mfa/yubikey">Configure Yubikey</a>
        </li>
        
        
        <li >
            <a href="https://help.passbolt.com/configure/mfa/duo">Configure Duo</a>
        </li>
        
        
        <li >
            <a href="https://help.passbolt.com/configure/notification/email">Configure Email Notifications</a>
        </li>
        
        
        <li >
            <a href="https://help.passbolt.com/configure/ldap/ldap-with-ssl">Configure LDAP with ssl</a>
        </li>
        
        
        <li >
            <a href="https://help.passbolt.com/configure/ldap/ldap-common-sync-error-messages">Troubleshoot LDAP sync errors</a>
        </li>
        
        
        <li >
            <a href="https://help.passbolt.com/configure/environment/reference">Environment variable reference</a>
        </li>
        
        
        <li >
            <a href="https://help.passbolt.com/configure/email/setup">Configure Email providers</a>
        </li>
        
        
        <li >
            <a href="https://help.passbolt.com/configure/https">Configure HTTPS</a>
        </li>
        
        
        <li >
            <a href="https://help.passbolt.com/faq/hosting/why-email-not-sent">Troobleshoot Email config</a>
        </li>
        
        
    </ul>
</div>








                
            </div>
            <div class="panel middle" data-spy="scroll" data-target=".scrollspy">
                <div class="grid grid-responsive-12">
                    <article>
                        <div class="row" id="introduction">
    <div class="col12">
        <div class="breadcrumbs">
            <ul>
                <li>
                    <div class="main-cell">
                        <a href="https://www.passbolt.com"><span>home</span></a>
                    </div>
                </li>
                <li>
                    <div class="main-cell">
                        <a href="/"><span>help</span></a>
                    </div>
                </li>
                
                
                <li>
                    <div class="main-cell">
                        <a href="https://help.passbolt.com/configure"><span>configure</span></a>
                    </div>
                </li>
                <li>
                    <div class="main-cell">
                        <a href="https://help.passbolt.com/configure/ldap"><span>ldap</span></a>
                    </div>
                </li>
                
                
                
                <li>
                    <div class="main-cell">
                        <a href="https://help.passbolt.com/configure/ldap/setup.html"><span>setup</span></a>
                    </div>
                </li>
                
            </ul>
        </div>
    </div>
</div>

                        <div class="row" markdown="1">
<div class="col7" markdown="1">
<h1>Configure Ldap plugin</h1>
</div>
</div>

                        <div class="row">
  <div class="col7">

    <p><img src="/assets/img/help/2018/09/AD_ldap_overview.png" alt="ldap illustration" style="margin: auto;" /></p>

    <div class="message warning">
    <p>
        <strong>Important:</strong> The LDAP connector will send an invitation email to all the users matching your configuration during a synchronization. If you are simply testing it, make sure not to perform an actual synchronization (use simulate sync instead), or disable the cron job to send emails first.
    </p>
    
</div>

    <h2 id="introduction">Introduction</h2>

    <h3 id="what-is-it">What is it?</h3>

    <p>The goal of the directory synchronization tool, also called LDAP connector, is to provide a way for a passbolt
administrator to synchronize a list of groups and users, as well as the associated group memberships.</p>

    <p>Currently the connector supports two types of directory: OpenLDAP and Microsoft Active Directory. In the future
we will also support other non ldap based user directories such as Google API User Directory.</p>

    <h3 id="how-does-it-work">How does it work?</h3>

    <p>In a nutshell this part of the application will try to keep passbolt and a directory in sync with a minimal
involvement of the administrators and group managers. However if an action is not possible, such as, deleting
a user that is the sole password owner, the process triggers will trigger relevant email notifications so
that a human can solve it manually. An admin can also alternatively tell passbolt to ignore a record in the
next synchronization round, if the issue does not need to be resolved.</p>

    <h3 id="requirements">Requirements</h3>

    <p>The directory synchronization tools requires the <a href="https://secure.php.net/manual/en/book.ldap.php">php-ldap extension</a>
to be present on the server. If you built your own server the way you install
<a href="https://packages.debian.org/stretch/php-ldap">php-ldap</a> will depend on your system flavor.</p>

    <p>On Debian using nginx for example you can do:</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt-get <span class="nb">install </span>php-ldap
<span class="nb">sudo </span>service nginx restart
</code></pre></div>    </div>

    <p>Make sure the ldap extension is present in the php-cli.ini file.
You should add <code class="language-plaintext highlighter-rouge">extension=ldap.so</code> if it is not already present:</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>php <span class="nt">-i</span> |grep php<span class="se">\.</span>ini
Configuration File <span class="o">(</span>php.ini<span class="o">)</span> Path <span class="o">=&gt;</span> /etc/php/7.0/cli
Loaded Configuration File <span class="o">=&gt;</span> /etc/php/7.0/cli/php.ini
<span class="nv">$ </span>nano /etc/php/7.0/cli/php.ini
</code></pre></div>    </div>

    <p>For testing purpose, it might be handy to have some <a href="https://wiki.debian.org/LDAP/LDAPUtils">ldap utilities</a>
installed on your system. On Debian you can use ldapsearch for example to search for and display entries:</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt-get <span class="nb">install </span>ldap-utils
ldapsearch <span class="nt">-b</span><span class="s1">'dc=example,dc=com'</span> <span class="nt">-x</span>
</code></pre></div>    </div>

    <p>The plugin relies on a 3rd party library called ldaptools which you will need to install as part of your passbolt
update or install. You can get it the same way than other php dependencies using composer:</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> /var/www/passbolt
git pull origin master
composer <span class="nb">install</span>
./bin/cake passbolt migrate
</code></pre></div>    </div>

    <p>To run, the ldap plugin needs to have at least one active admin user existing inside passbolt.</p>

    <h2 id="limitations">Limitations</h2>

    <p>The Ldap plugin doesn‚Äôt support nested groups in the current version. This improvement will be added later,
once groups inside groups is supported by passbolt.</p>

    <p>A delegated authentication (such as using a LDAP user password as replacement of the passphrase) is currently
not supported (and is not a trivial problem) but could still be considered in the future. If you are interested
in this feature you can join the discussion on the
<a href="https://community.passbolt.com/t/as-a-user-i-can-login-using-my-organization-ldap-credentials/159">community forum</a>.</p>

    <p>The following improvements will also be shipped gradually and will be available soon:</p>
    <ul>
      <li>Test mode: the capability to test the configuration and mapping directly from the configuration screen.</li>
      <li>Report screens: the synchronization reports will be available in the admin workspace.</li>
    </ul>

    <h2 id="how-to-use">How to use?</h2>

    <div class="message warning">
    <p>
        <strong>Please note:</strong> This guide explains how to configure the Ldap connector through the UI. For complex configurations (for example custom field mapping in openldap) you will need to <a href="/configure/ldap/ldap-from-configuration-file">configure ldap directly through the configuration file</a>.
    </p>
    
</div>

    <h3 id="activate-the-plugin">Activate the plugin</h3>

    <p>The plugin is deactivated by default. You need to activate it to be able to use it.
While logged in as an admin, click on the administration menu item in the top menu, and then click on ‚ÄúUsers Directory‚Äù</p>

    <figure>
    <img src="https://help.passbolt.com/assets/img/help/2018/12/AD_directory_sync_settings_disabled.png" alt="Ldap directory settings screen (disabled)" style="max-width:660px;" />
    <span class="legend">fig. Ldap directory settings screen (disabled)</span>
</figure>

    <p>Click on the switch next to ‚ÄúUsers Directory‚Äù to enable the plugin.</p>

    <figure>
    <img src="https://help.passbolt.com/assets/img/help/2018/12/AD_directory_sync_settings_enabled.png" alt="Ldap directory settings screen (enabled)" style="max-width:660px;" />
    <span class="legend">fig. Ldap directory settings screen (enabled)</span>
</figure>

    <p>You will need to fill the configuration parameters with your connection details before you can save the settings and
actually activate it.</p>

    <h3 id="configure-the-plugin">Configure the plugin</h3>

    <p>The available options are:</p>

    <table class="table-parameters">
  <thead>
    <tr>
        <th width="25%">Parameter</th>
        <th width="33%">Details</th>
        <th>Example</th>
    </tr>
  </thead>
  <tbody>
    <tr>
        <td>
        Directory Type<br />
        <em>(required)</em>
        </td>
        <td>
        Choose here the type of your directory. Currently only Active Directory and OpenLdap are supported.
        </td>
        <td>
        <code>Active Directory</code>
        </td>
    </tr>
    <tr>
        <td>
        Domain<br />
        <em>(required)</em>
        </td>
        <td>
        The domain your directory is configured with.
        </td>
        <td>
        <code>mydomain.local</code>
        </td>
    </tr>
    <tr>
        <td>
        Server URL<br />
        <em>(required)</em>
        </td>
        <td>
        The full url to reach your server.
        </td>
        <td>
        <code>ldap://198.163.0.1:389</code>
        </td>
     </tr>
     <tr>
         <td>
         Username and password<br />
         <em>(required)</em>
         </td>
         <td>
         Username and password to authentify on your directory
         </td>
         <td>
         </td>
     </tr>
     <tr>
          <td>
          Base DN<br />
          <em>(required)</em>
          </td>
          <td>
          The base DN (default naming context) for the domain.
          </td>
          <td>
          <code>OU=OrgUsers,DC=mydomain,DC=local</code>
          </td>
     </tr>
     <tr>
        <td>
        Group path<br />
        <em>(optional)</em>
        </td>
        <td>
        If your groups are located in a different path than your base DN, you can specify here the complementary path.
        <br /><br />Default value: none
        </td>
        <td><code>OU=MyGroups</code></td>
     </tr>
     <tr>
         <td>
         User path<br />
         <em>(optional)</em>
         </td>
         <td>
         If your users are located in a different path than your base DN, you can specify here the complementary path.
         <br /><br />Default value: none
         </td>
         <td><code>OU=MyUsers</code></td>
      </tr>
      <tr>
      <td>
           Group object class<br />
           <em>(optional)</em>
           </td>
           <td>
           For OpenLdap only, you can specify here the name of the group object class that you are using in your openldap.
           <br /><br />Default value: groupOfUniqueNames
           </td>
           <td>
           <code>groupOfUniqueNames</code>
           </td>
        </tr>
        <tr>
            <td>
            User object class<br />
            <em>(optional)</em>
            </td>
            <td>
            For OpenLdap only, you can specify here the name of the user object class that you are using in your openldap.
            <br /><br />Default value: inetOrgPerson
            </td>
            <td>
            <code>inetOrgPerson</code>
            </td>
        </tr>
        <tr>
            <td>
            Default admin<br />
            <em>(required)</em>
            </td>
            <td>
            Choose here the username of the passbolt admin user that will be used to perform the operations on behalf of the synchronization tools.
            <br /><br />You can also create a dedicated admin user in passbolt if you want to be able to track more accurately the actions related to ldap.
            </td>
            <td>
            <code>passboltadmin@domain.com</code>
            </td>
        </tr>
        <tr>
            <td>
            Default group admin <br />
            <em>(required)</em>
            </td>
            <td>
            Choose here the username of the default group manager. It is the user that will be assigned as a group manager to all new groups created by ldap.
            </td>
            <td>
            <code>passboltadmin@domain.com</code>
            </td>
        </tr>
        <tr>
            <td>
            Groups parent group <br />
            <em>(optional)</em>
            </td>
            <td>
            Using this filter will list only groups that are part of the given parent group (recursively). Enter the parent group name.
            </td>
            <td>
            <code>MyGroupName</code>
            </td>
        </tr>
        <tr>
            <td>
            Users parent group <br />
            <em>(optional)</em>
            </td>
            <td>
            Using this filter will list only users that are part of the given parent group (recursively). Enter the parent group name.
            </td>
            <td>
            <code>MyGroupName</code>
            </td>
        </tr>
        <tr>
            <td>
            Enabled users only <br />
            <em>(optional)</em>
            </td>
            <td>
            Only for AD. Synchronize only the users that are enabled (=not disabled).
            </td>
            <td>
            </td>
        </tr>
      <tr>
           <td>
           Sync operations<br />
           <em>(optional)</em>
           </td>
           <td>
           By default, the synchronization will be done for all created / deleted users and groups in your directory and all edited group members. You can enable / disable some tasks here.
           <br /><br />Default value: everything is enabled.
           </td>
           <td>
           </td>
        </tr>
  </tbody>
</table>

    <h3 id="save-configuration">Save configuration</h3>

    <p>Once the configuration is entered, do not forgetto save it by clicking on the ‚Äúsave settings‚Äù at the top. The configuration will be saved
only if passbolt managed to connect to your directory. If not, it will display an error message.</p>

    <figure>
    <img src="https://help.passbolt.com/assets/img/help/2018/12/AD_directory_sync_settings_saved.png" alt="Ldap directory settings have been saved" style="max-width:660px;" />
    <span class="legend">fig. Ldap directory settings have been saved</span>
</figure>

    <h3 id="test-configuration-and-simulate-sync">Test configuration and simulate sync</h3>

    <p>Once the settings have been saved, the buttons ‚Äúsimulate synchronize‚Äù and ‚Äúsynchronize‚Äù at the top have become clickable.</p>

    <p>Before we actually do a real synchronization, we will first simulate one. Click on ‚Äúsimulate synchronize‚Äù and wait a few seconds. Once the simulation is complete,
a report such as the one below will be displayed.</p>

    <figure>
    <img src="https://help.passbolt.com/assets/img/help/2018/12/AD_directory_sync_simulation.png" alt="Ldap directory sync simulation" style="max-width:660px;" />
    <span class="legend">fig. Ldap directory sync simulation</span>
</figure>

    <p>In this report, you will be able to see what will actually happen when you will synchronize your directory for real. You will also be
able to take corrective measures before an error actually happens.</p>

    <h3 id="first-synchronization">First synchronization</h3>

    <p>To do the first synchronization, repeat the same process as above. Only, click on ‚Äúsynchronize‚Äù this time. A similar report to the one that was displayed during a simulate
will appear and let you know what happened exactly.</p>

    <h3 id="how-to-synchronize-my-directory-automatically">How to synchronize my directory automatically?</h3>
    <p>To synchronize the changes automatically you will need to add a cron job on your server. We recommend to execute the job once a day, but you can choose as per your preference.</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0 0 <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> su <span class="nt">-c</span> <span class="s2">"/var/www/passbolt/bin/cake directory_sync all"</span> <span class="nt">-s</span> /bin/bash www-data <span class="o">&gt;&gt;</span> /var/log/cron.log 2&gt;&amp;1
</code></pre></div>    </div>

    <h2 id="configure-ldap-with-ssl-ldaps">Configure ldap with SSL (ldaps)</h2>
    <p>If your configuration doesn‚Äôt run out of the box with ldaps, you can refer to the <a href="/configure/ldap-with-ssl">ldap with ssl</a> documentation in order to adjust your config or throubleshoot your issue.</p>

    <div class="last-updated">
      <h3>Last updated</h3>
      <p>This article was last updated on 
December
4th,
2018.</p>
    </div>

  </div>
  <div class="col4 last push1">

    <div class="message tldr notice">
    <p>Are you experiencing issues with Passbolt Pro Edition?</p>
    <a href="mailto:contact@passbolt.com" class="button primary">Contact Pro support</a>
    <p>or <a href="https://community.passbolt.com">ask the community</a></p>

</div>

  </div>
</div>

                    </article>
                </div>
            </div>
        </div>
            <footer>
        <div class="footer">
            <ul class="footer-links">
                <li><a href="https://www.passbolt.com/licence">Terms</a></li>
                <li><a href="https://www.passbolt.com/privacy">Privacy</a></li>
                <li><a href="https://www.passbolt.com/credits">Credits</a></li>
                <li><a href="https://careers.passbolt.com">Careers</a></li>
            </ul>
        </div>
    </footer>
    <div id="cookies-eu-banner" class="visually-hidden">
        üç™ &nbsp; Do you accept cookies for statistical purposes?
        <a href="https://www.passbolt.com/privacy" id="cookies-eu-more">(Read more)</a>
        <a class="button primary" id="cookies-eu-accept">Accept</a>
        <a id="cookies-eu-reject">No thanks!</a>
    </div>


    </div>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-23506466-3"></script>
<script src="https://code.jquery.com/jquery-3.5.0.slim.min.js" integrity="sha384-/IFzzQmt1S744I+IQO4Mc1uphkxbXt1tEwjQ/qSw2p8pXWck09sLvqHmKDYYwReJ" crossorigin="anonymous"></script>
<script src="https://help.passbolt.com/assets/js/cookies-eu-banner.js"></script>
<script src="https://help.passbolt.com/assets/js/analytics.js"></script>
<script src="https://help.passbolt.com/assets/js/greedynav.js"></script>
</body>

</html>